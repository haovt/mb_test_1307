webpackJsonp([72],{2110:function(n,e,l){"use strict";function View_CoreCommentsViewerPage_1(n){return t._42(0,[(n()(),t._16(0,0,null,null,6,"button",[["clear",""],["icon-only",""],["ion-button",""],["item-end",""]],[[1,"aria-label",0]],[[null,"click"]],function(n,e,l){var t=!0;if("click"===e){t=!1!==n.component.toggleDelete(l)&&t}return t},T.b,T.a)),t._15(1,1097728,[[2,4]],0,M.a,[[8,""],A.a,t.p,t.K],{clear:[0,"clear"]},null),t._32(131072,E.a,[W.a,t.i]),(n()(),t._40(-1,0,["\n                "])),(n()(),t._16(4,0,null,0,1,"ion-icon",[["ios","md-create"],["name","create"],["role","img"]],[[2,"hide",null]],null,null,null,null)),t._15(5,147456,null,0,S.a,[A.a,t.p,t.K],{name:[0,"name"],ios:[1,"ios"]},null),(n()(),t._40(-1,0,["\n            "]))],function(n,e){n(e,1,0,"");n(e,5,0,"create","md-create")},function(n,e){n(e,0,0,t._41(e,0,0,t._29(e,2).transform("core.delete")));n(e,4,0,t._29(e,5)._hidden)})}function View_CoreCommentsViewerPage_2(n){return t._42(0,[(n()(),t._16(0,0,null,null,2,"core-empty-box",[["icon","chatbubbles"]],null,null,null,X.b,X.a)),t._15(1,49152,null,0,$.a,[],{message:[0,"message"],icon:[1,"icon"]},null),t._32(131072,E.a,[W.a,t.i])],function(n,e){n(e,1,0,t._41(e,1,0,t._29(e,2).transform("core.comments.nocomments")),"chatbubbles")},null)}function View_CoreCommentsViewerPage_3(n){return t._42(0,[(n()(),t._16(0,0,null,null,8,"div",[["class","core-warning-card"],["icon-start",""]],null,null,null,null,null)),(n()(),t._40(-1,null,["\n            "])),(n()(),t._16(2,0,null,null,1,"ion-icon",[["name","warning"],["role","img"]],[[2,"hide",null]],null,null,null,null)),t._15(3,147456,null,0,S.a,[A.a,t.p,t.K],{name:[0,"name"]},null),(n()(),t._40(4,null,["\n            ","\n        "])),t._32(131072,E.a,[W.a,t.i]),t._34(6,1),t._33(7,{$a:0}),t._32(131072,E.a,[W.a,t.i])],function(n,e){n(e,3,0,"warning")},function(n,e){n(e,2,0,t._29(e,3)._hidden);n(e,4,0,t._41(e,4,0,t._29(e,8).transform("core.thereisdatatosync",n(e,7,0,t._41(e,4,0,n(e,6,0,t._29(e.parent,0),t._41(e,4,0,t._29(e,5).transform("core.comments.comments"))))))))})}function View_CoreCommentsViewerPage_5(n){return t._42(0,[(n()(),t._16(0,0,null,null,6,"button",[["clear",""],["color","danger"],["icon-only",""],["ion-button",""],["item-end",""]],[[24,"@coreSlideInOut",0],[1,"aria-label",0]],[[null,"click"]],function(n,e,l){var t=!0,o=n.component;if("click"===e){t=!1!==o.deleteComment(l,o.offlineComment)&&t}return t},T.b,T.a)),t._15(1,1097728,[[4,4]],0,M.a,[[8,""],A.a,t.p,t.K],{color:[0,"color"],clear:[1,"clear"]},null),t._32(131072,E.a,[W.a,t.i]),(n()(),t._40(-1,0,["\n                    "])),(n()(),t._16(4,0,null,0,1,"ion-icon",[["name","trash"],["role","img"]],[[2,"hide",null]],null,null,null,null)),t._15(5,147456,null,0,S.a,[A.a,t.p,t.K],{name:[0,"name"]},null),(n()(),t._40(-1,0,["\n                "]))],function(n,e){n(e,1,0,"danger","");n(e,5,0,"trash")},function(n,e){n(e,0,0,"fromRight",t._41(e,0,1,t._29(e,2).transform("core.delete")));n(e,4,0,t._29(e,5)._hidden)})}function View_CoreCommentsViewerPage_4(n){return t._42(0,[(n()(),t._16(0,0,null,null,38,"ion-card",[],null,[[null,"click"]],function(n,e,l){var t=!0;if("click"===e){t=!1!==n.component.addComment(l)&&t}return t},null,null)),t._15(1,16384,null,0,R.a,[A.a,t.p,t.K],null,null),(n()(),t._40(-1,null,["\n            "])),(n()(),t._16(3,0,null,null,23,"ion-item",[["class","item item-block"],["text-wrap",""]],null,null,null,j.b,j.a)),t._15(4,1097728,null,3,F.a,[H.a,A.a,t.p,t.K,[2,z.a]],null,null),t._37(335544320,3,{contentLabel:0}),t._37(603979776,4,{_buttons:1}),t._37(603979776,5,{_icons:1}),t._15(8,16384,null,0,B.a,[],null,null),(n()(),t._40(-1,2,["\n                "])),(n()(),t._16(10,0,null,0,2,"ion-avatar",[["core-user-avatar",""],["item-start",""]],null,null,null,G.b,G.a)),t._15(11,770048,null,0,J.a,[Y.a,a.a,q.a,Q.a,s.a,[2,Z.a]],{user:[0,"user"]},null),t._15(12,16384,null,0,nn.a,[],null,null),(n()(),t._40(-1,2,["\n                "])),(n()(),t._16(14,0,null,2,1,"h2",[],null,null,null,null,null)),(n()(),t._40(15,null,["",""])),(n()(),t._40(-1,2,["\n                "])),(n()(),t._16(17,0,null,2,5,"p",[],null,null,null,null,null)),(n()(),t._40(-1,null,["\n                    "])),(n()(),t._16(19,0,null,null,1,"ion-icon",[["name","time"],["role","img"]],[[2,"hide",null]],null,null,null,null)),t._15(20,147456,[[5,4]],0,S.a,[A.a,t.p,t.K],{name:[0,"name"]},null),(n()(),t._40(21,null,[" ","\n                "])),t._32(131072,E.a,[W.a,t.i]),(n()(),t._40(-1,2,["\n                "])),(n()(),t._11(16777216,null,4,1,null,View_CoreCommentsViewerPage_5)),t._15(25,16384,null,0,en.k,[t.W,t.T],{ngIf:[0,"ngIf"]},null),(n()(),t._40(-1,2,["\n            "])),(n()(),t._40(-1,null,["\n            "])),(n()(),t._16(28,0,null,null,9,"ion-item",[["class","item item-block"],["text-wrap",""]],null,null,null,j.b,j.a)),t._15(29,1097728,null,3,F.a,[H.a,A.a,t.p,t.K,[2,z.a]],null,null),t._37(335544320,6,{contentLabel:0}),t._37(603979776,7,{_buttons:1}),t._37(603979776,8,{_icons:1}),t._15(33,16384,null,0,B.a,[],null,null),(n()(),t._40(-1,2,["\n                "])),(n()(),t._16(35,16777216,null,2,1,"core-format-text",[["clean","true"]],null,null,null,null,null)),t._15(36,540672,null,0,ln.a,[t.p,a.a,i.a,r.a,W.a,tn.a,q.a,on.a,an.a,rn.a,Q.a,un.a,[2,Y.a],[2,sn.a],[2,Z.a],cn.a,s.a,mn.a,_n.a,fn.a,t.W],{text:[0,"text"],clean:[1,"clean"],contextLevel:[2,"contextLevel"],contextInstanceId:[3,"contextInstanceId"],courseId:[4,"courseId"]},null),(n()(),t._40(-1,2,["\n            "])),(n()(),t._40(-1,null,["\n        "]))],function(n,e){var l=e.component;n(e,11,0,l.offlineComment);n(e,20,0,"time");n(e,25,0,l.showDelete);n(e,36,0,l.offlineComment.content,"true",l.contextLevel,l.instanceId,l.courseId)},function(n,e){n(e,15,0,e.component.offlineComment.fullname);n(e,19,0,t._29(e,20)._hidden);n(e,21,0,t._41(e,21,0,t._29(e,22).transform("core.notsent")))})}function View_CoreCommentsViewerPage_7(n){return t._42(0,[(n()(),t._16(0,0,null,null,2,"p",[],null,null,null,null,null)),(n()(),t._40(1,null,["",""])),t._34(2,2)],null,function(n,e){n(e,1,0,t._41(e,1,0,n(e,2,0,t._29(e.parent.parent,1),1e3*e.parent.context.$implicit.timecreated,"strftimerecentfull")))})}function View_CoreCommentsViewerPage_8(n){return t._42(0,[(n()(),t._16(0,0,null,null,8,"p",[],null,null,null,null,null)),(n()(),t._40(-1,null,["\n                    "])),(n()(),t._16(2,0,null,null,1,"ion-icon",[["name","trash"],["role","img"]],[[2,"hide",null]],null,null,null,null)),t._15(3,147456,[[11,4]],0,S.a,[A.a,t.p,t.K],{name:[0,"name"]},null),(n()(),t._40(-1,null,[" "])),(n()(),t._16(5,0,null,null,2,"span",[["text-wrap",""]],null,null,null,null,null)),(n()(),t._40(6,null,["",""])),t._32(131072,E.a,[W.a,t.i]),(n()(),t._40(-1,null,["\n                "]))],function(n,e){n(e,3,0,"trash")},function(n,e){n(e,2,0,t._29(e,3)._hidden);n(e,6,0,t._41(e,6,0,t._29(e,7).transform("core.deletedoffline")))})}function View_CoreCommentsViewerPage_9(n){return t._42(0,[(n()(),t._16(0,0,null,null,6,"button",[["clear",""],["color","danger"],["icon-only",""],["ion-button",""],["item-end",""]],[[24,"@coreSlideInOut",0],[1,"aria-label",0]],[[null,"click"]],function(n,e,l){var t=!0;if("click"===e){t=!1!==n.component.deleteComment(l,n.parent.context.$implicit)&&t}return t},T.b,T.a)),t._15(1,1097728,[[10,4]],0,M.a,[[8,""],A.a,t.p,t.K],{color:[0,"color"],clear:[1,"clear"]},null),t._32(131072,E.a,[W.a,t.i]),(n()(),t._40(-1,0,["\n                    "])),(n()(),t._16(4,0,null,0,1,"ion-icon",[["name","trash"],["role","img"]],[[2,"hide",null]],null,null,null,null)),t._15(5,147456,null,0,S.a,[A.a,t.p,t.K],{name:[0,"name"]},null),(n()(),t._40(-1,0,["\n                "]))],function(n,e){n(e,1,0,"danger","");n(e,5,0,"trash")},function(n,e){n(e,0,0,"fromRight",t._41(e,0,1,t._29(e,2).transform("core.delete")));n(e,4,0,t._29(e,5)._hidden)})}function View_CoreCommentsViewerPage_10(n){return t._42(0,[(n()(),t._16(0,0,null,null,6,"button",[["clear",""],["color","danger"],["icon-only",""],["ion-button",""],["item-end",""]],[[1,"aria-label",0]],[[null,"click"]],function(n,e,l){var t=!0;if("click"===e){t=!1!==n.component.undoDeleteComment(l,n.parent.context.$implicit)&&t}return t},T.b,T.a)),t._15(1,1097728,[[10,4]],0,M.a,[[8,""],A.a,t.p,t.K],{color:[0,"color"],clear:[1,"clear"]},null),t._32(131072,E.a,[W.a,t.i]),(n()(),t._40(-1,0,["\n                    "])),(n()(),t._16(4,0,null,0,1,"ion-icon",[["name","undo"],["role","img"]],[[2,"hide",null]],null,null,null,null)),t._15(5,147456,null,0,S.a,[A.a,t.p,t.K],{name:[0,"name"]},null),(n()(),t._40(-1,0,["\n                "]))],function(n,e){n(e,1,0,"danger","");n(e,5,0,"undo")},function(n,e){n(e,0,0,t._41(e,0,0,t._29(e,2).transform("core.restore")));n(e,4,0,t._29(e,5)._hidden)})}function View_CoreCommentsViewerPage_6(n){return t._42(0,[(n()(),t._16(0,0,null,null,40,"ion-card",[],null,null,null,null,null)),t._15(1,16384,null,0,R.a,[A.a,t.p,t.K],null,null),(n()(),t._40(-1,null,["\n            "])),(n()(),t._16(3,0,null,null,25,"ion-item",[["class","item item-block"],["text-wrap",""]],null,null,null,j.b,j.a)),t._15(4,1097728,null,3,F.a,[H.a,A.a,t.p,t.K,[2,z.a]],null,null),t._37(335544320,9,{contentLabel:0}),t._37(603979776,10,{_buttons:1}),t._37(603979776,11,{_icons:1}),t._15(8,16384,null,0,B.a,[],null,null),(n()(),t._40(-1,2,["\n                "])),(n()(),t._16(10,0,null,0,2,"ion-avatar",[["core-user-avatar",""],["item-start",""]],null,null,null,G.b,G.a)),t._15(11,770048,null,0,J.a,[Y.a,a.a,q.a,Q.a,s.a,[2,Z.a]],{user:[0,"user"]},null),t._15(12,16384,null,0,nn.a,[],null,null),(n()(),t._40(-1,2,["\n                "])),(n()(),t._16(14,0,null,2,1,"h2",[],null,null,null,null,null)),(n()(),t._40(15,null,["",""])),(n()(),t._40(-1,2,["\n                "])),(n()(),t._11(16777216,null,2,1,null,View_CoreCommentsViewerPage_7)),t._15(18,16384,null,0,en.k,[t.W,t.T],{ngIf:[0,"ngIf"]},null),(n()(),t._40(-1,2,["\n                "])),(n()(),t._11(16777216,null,2,1,null,View_CoreCommentsViewerPage_8)),t._15(21,16384,null,0,en.k,[t.W,t.T],{ngIf:[0,"ngIf"]},null),(n()(),t._40(-1,2,["\n                "])),(n()(),t._11(16777216,null,4,1,null,View_CoreCommentsViewerPage_9)),t._15(24,16384,null,0,en.k,[t.W,t.T],{ngIf:[0,"ngIf"]},null),(n()(),t._40(-1,2,["\n                "])),(n()(),t._11(16777216,null,4,1,null,View_CoreCommentsViewerPage_10)),t._15(27,16384,null,0,en.k,[t.W,t.T],{ngIf:[0,"ngIf"]},null),(n()(),t._40(-1,2,["\n            "])),(n()(),t._40(-1,null,["\n            "])),(n()(),t._16(30,0,null,null,9,"ion-item",[["class","item item-block"],["text-wrap",""]],null,null,null,j.b,j.a)),t._15(31,1097728,null,3,F.a,[H.a,A.a,t.p,t.K,[2,z.a]],null,null),t._37(335544320,12,{contentLabel:0}),t._37(603979776,13,{_buttons:1}),t._37(603979776,14,{_icons:1}),t._15(35,16384,null,0,B.a,[],null,null),(n()(),t._40(-1,2,["\n                "])),(n()(),t._16(37,16777216,null,2,1,"core-format-text",[],null,null,null,null,null)),t._15(38,540672,null,0,ln.a,[t.p,a.a,i.a,r.a,W.a,tn.a,q.a,on.a,an.a,rn.a,Q.a,un.a,[2,Y.a],[2,sn.a],[2,Z.a],cn.a,s.a,mn.a,_n.a,fn.a,t.W],{text:[0,"text"],contextLevel:[1,"contextLevel"],contextInstanceId:[2,"contextInstanceId"],courseId:[3,"courseId"]},null),(n()(),t._40(-1,2,["\n            "])),(n()(),t._40(-1,null,["\n        "]))],function(n,e){var l=e.component;n(e,11,0,e.context.$implicit);n(e,18,0,!e.context.$implicit.deleted);n(e,21,0,e.context.$implicit.deleted);n(e,24,0,l.showDelete&&!e.context.$implicit.deleted&&e.context.$implicit.delete);n(e,27,0,l.showDelete&&e.context.$implicit.deleted);n(e,38,0,e.context.$implicit.content,l.contextLevel,l.instanceId,l.courseId)},function(n,e){n(e,15,0,e.context.$implicit.fullname)})}function View_CoreCommentsViewerPage_11(n){return t._42(0,[(n()(),t._16(0,0,null,null,13,"ion-fab",[["bottom",""],["core-fab",""],["end",""]],null,null,null,dn.b,dn.a)),t._15(1,212992,null,0,hn.a,[t.p,sn.a],null,null),t._15(2,1228800,null,2,pn.a,[tn.a],null,null),t._37(335544320,15,{_mainButton:0}),t._37(603979776,16,{_fabLists:1}),(n()(),t._40(-1,0,["\n        "])),(n()(),t._16(6,0,null,0,6,"button",[["ion-fab",""]],[[1,"aria-label",0]],[[null,"click"]],function(n,e,l){var t=!0;if("click"===e){t=!1!==n.component.addComment(l)&&t}return t},Cn.b,Cn.a)),t._15(7,49152,[[15,4]],0,gn.a,[A.a,t.p,t.K],null,null),t._32(131072,E.a,[W.a,t.i]),(n()(),t._40(-1,0,["\n            "])),(n()(),t._16(10,0,null,0,1,"ion-icon",[["name","add"],["role","img"]],[[2,"hide",null]],null,null,null,null)),t._15(11,147456,null,0,S.a,[A.a,t.p,t.K],{name:[0,"name"]},null),(n()(),t._40(-1,0,["\n        "])),(n()(),t._40(-1,0,["\n    "]))],function(n,e){n(e,1,0);n(e,11,0,"add")},function(n,e){n(e,6,0,t._41(e,6,0,t._29(e,8).transform("core.comments.addcomment")));n(e,10,0,t._29(e,11)._hidden)})}function View_CoreCommentsViewerPage_0(n){return t._42(0,[t._32(0,en.h,[]),t._32(0,yn.a,[an.a,u.a]),t._37(402653184,1,{content:0}),(n()(),t._16(3,0,null,null,32,"ion-header",[],null,null,null,null,null)),t._15(4,16384,null,0,vn.a,[A.a,t.p,t.K,[2,wn.a]],null,null),(n()(),t._40(-1,null,["\n    "])),(n()(),t._16(6,0,null,null,28,"ion-navbar",[["class","toolbar"],["core-back-button",""]],[[8,"hidden",0],[2,"statusbar-padding",null]],null,null,bn.b,bn.a)),t._15(7,49152,null,0,In.a,[Pn.a,[2,wn.a],[2,Y.a],A.a,t.p,t.K],null,null),t._15(8,212992,null,0,xn.a,[In.a,tn.a,W.a,s.a],null,null),(n()(),t._40(-1,3,["\n        "])),(n()(),t._16(10,0,null,3,3,"ion-title",[],null,null,null,Vn.b,Vn.a)),t._15(11,49152,null,0,Dn.a,[A.a,t.p,t.K,[2,Ln.a],[2,In.a]],null,null),(n()(),t._16(12,16777216,null,0,1,"core-format-text",[],null,null,null,null,null)),t._15(13,540672,null,0,ln.a,[t.p,a.a,i.a,r.a,W.a,tn.a,q.a,on.a,an.a,rn.a,Q.a,un.a,[2,Y.a],[2,sn.a],[2,Z.a],cn.a,s.a,mn.a,_n.a,fn.a,t.W],{text:[0,"text"],contextLevel:[1,"contextLevel"],contextInstanceId:[2,"contextInstanceId"],courseId:[3,"courseId"]},null),(n()(),t._40(-1,3,["\n        "])),(n()(),t._16(15,0,null,2,18,"ion-buttons",[["end",""]],null,null,null,null,null)),t._15(16,16384,null,1,kn.a,[A.a,t.p,t.K,[2,Ln.a],[2,In.a]],null,null),t._37(603979776,2,{_buttons:1}),(n()(),t._40(-1,null,["\n            "])),(n()(),t._11(16777216,null,null,1,null,View_CoreCommentsViewerPage_1)),t._15(20,16384,null,0,en.k,[t.W,t.T],{ngIf:[0,"ngIf"]},null),(n()(),t._40(-1,null,["\n            "])),(n()(),t._16(22,0,null,null,10,"core-context-menu",[],null,null,null,On.b,On.a)),t._15(23,245760,null,0,Un.a,[W.a,Nn.a,t.p,i.a,[2,Kn.a],q.a],null,null),(n()(),t._40(-1,0,["\n                "])),(n()(),t._16(25,0,null,0,2,"core-context-menu-item",[],null,[[null,"action"]],function(n,e,l){var t=!0;if("action"===e){t=!1!==n.component.refreshComments(!1)&&t}return t},Tn.b,Tn.a)),t._15(26,770048,null,0,Mn.a,[Un.a],{content:[0,"content"],iconAction:[1,"iconAction"],closeOnClick:[2,"closeOnClick"],priority:[3,"priority"],hidden:[4,"hidden"]},{action:"action"}),t._32(131072,E.a,[W.a,t.i]),(n()(),t._40(-1,0,["\n                "])),(n()(),t._16(29,0,null,0,2,"core-context-menu-item",[],null,[[null,"action"]],function(n,e,l){var t=!0;if("action"===e){t=!1!==n.component.refreshComments(!0)&&t}return t},Tn.b,Tn.a)),t._15(30,770048,null,0,Mn.a,[Un.a],{content:[0,"content"],iconAction:[1,"iconAction"],closeOnClick:[2,"closeOnClick"],priority:[3,"priority"],hidden:[4,"hidden"]},{action:"action"}),t._32(131072,E.a,[W.a,t.i]),(n()(),t._40(-1,0,["\n            "])),(n()(),t._40(-1,null,["\n        "])),(n()(),t._40(-1,3,["\n    "])),(n()(),t._40(-1,null,["\n"])),(n()(),t._40(-1,null,["\n"])),(n()(),t._16(37,0,null,null,32,"ion-content",[],[[2,"statusbar-padding",null],[2,"has-refresher",null]],null,null,An.b,An.a)),t._15(38,4374528,[[1,4]],0,sn.a,[A.a,tn.a,En.a,t.p,t.K,Pn.a,Wn.a,t.D,[2,wn.a],[2,Y.a]],null,null),(n()(),t._40(-1,1,["\n    "])),(n()(),t._16(40,0,null,2,6,"ion-refresher",[],[[2,"refresher-active",null],[4,"top",null]],[[null,"ionRefresh"]],function(n,e,l){var t=!0;if("ionRefresh"===e){t=!1!==n.component.refreshComments(!1,l)&&t}return t},null,null)),t._15(41,212992,null,0,Sn.a,[tn.a,sn.a,t.D,Xn.l],{enabled:[0,"enabled"]},{ionRefresh:"ionRefresh"}),(n()(),t._40(-1,null,["\n        "])),(n()(),t._16(43,0,null,null,2,"ion-refresher-content",[],[[1,"state",0]],null,null,$n.b,$n.a)),t._15(44,114688,null,0,Rn.a,[Sn.a,A.a],{pullingText:[0,"pullingText"]},null),t._32(131072,E.a,[W.a,t.i]),(n()(),t._40(-1,null,["\n    "])),(n()(),t._40(-1,1,["\n    "])),(n()(),t._16(48,0,null,1,17,"core-loading",[],null,null,null,jn.b,jn.a)),t._15(49,638976,null,0,Fn.a,[W.a,t.p,s.a,q.a],{hideUntil:[0,"hideUntil"]},null),(n()(),t._40(-1,0,["\n        "])),(n()(),t._11(16777216,null,0,1,null,View_CoreCommentsViewerPage_2)),t._15(52,16384,null,0,en.k,[t.W,t.T],{ngIf:[0,"ngIf"]},null),(n()(),t._40(-1,0,["\n\n        "])),(n()(),t._11(16777216,null,0,1,null,View_CoreCommentsViewerPage_3)),t._15(55,16384,null,0,en.k,[t.W,t.T],{ngIf:[0,"ngIf"]},null),(n()(),t._40(-1,0,["\n\n        "])),(n()(),t._11(16777216,null,0,1,null,View_CoreCommentsViewerPage_4)),t._15(58,16384,null,0,en.k,[t.W,t.T],{ngIf:[0,"ngIf"]},null),(n()(),t._40(-1,0,["\n\n        "])),(n()(),t._11(16777216,null,0,1,null,View_CoreCommentsViewerPage_6)),t._15(61,802816,null,0,en.j,[t.W,t.T,t.v],{ngForOf:[0,"ngForOf"]},null),(n()(),t._40(-1,0,["\n\n        "])),(n()(),t._16(63,0,null,0,1,"core-infinite-loading",[],null,[[null,"action"]],function(n,e,l){var t=!0;if("action"===e){t=!1!==n.component.loadMore(l)&&t}return t},Hn.b,Hn.a)),t._15(64,573440,null,0,zn.a,[[2,sn.a],i.a],{enabled:[0,"enabled"],error:[1,"error"]},{action:"action"}),(n()(),t._40(-1,0,["\n    "])),(n()(),t._40(-1,1,["\n\n    "])),(n()(),t._11(16777216,null,0,1,null,View_CoreCommentsViewerPage_11)),t._15(68,16384,null,0,en.k,[t.W,t.T],{ngIf:[0,"ngIf"]},null),(n()(),t._40(-1,1,["\n"])),(n()(),t._40(-1,null,["\n"]))],function(n,e){var l=e.component;n(e,8,0);n(e,13,0,l.title,l.contextLevel,l.instanceId,l.courseId);n(e,20,0,l.canDeleteComments),n(e,23,0);n(e,26,0,t._41(e,26,0,t._29(e,27).transform("core.refresh")),l.refreshIcon,!0,100,!(l.commentsLoaded&&!l.hasOffline));n(e,30,0,t._41(e,30,0,t._29(e,31).transform("core.settings.synchronizenow")),l.syncIcon,!1,100,!(l.commentsLoaded&&l.hasOffline));n(e,41,0,l.commentsLoaded);n(e,44,0,t._19(1,"",t._41(e,44,0,t._29(e,45).transform("core.pulltorefresh")),""));n(e,49,0,l.commentsLoaded);n(e,52,0,!l.comments||!l.comments.length);n(e,55,0,l.hasOffline);n(e,58,0,l.offlineComment);n(e,61,0,l.comments);n(e,64,0,l.canLoadMore,l.loadMoreError);n(e,68,0,l.canAddComments)},function(n,e){n(e,6,0,t._29(e,7)._hidden,t._29(e,7)._sbPadding);n(e,37,0,t._29(e,38).statusbarPadding,t._29(e,38)._hasRefresher);n(e,40,0,"inactive"!==t._29(e,41).state,t._29(e,41)._top);n(e,43,0,t._29(e,44).r.state)})}Object.defineProperty(e,"__esModule",{value:!0});var t=l(1),o=(l(0),l(6),l(4)),a=(l(744),l(2)),i=l(5),r=l(12),u=l(25),s=l(10),c=l(46),m=l(154),_=l(388),f=l(521),d=function(){function CoreCommentsViewerPage(n,e,l,t,o,a,i,r,u,s,c,m){var _=this;this.sitesProvider=e,this.userProvider=l,this.domUtils=t,this.translate=o,this.modalCtrl=a,this.commentsProvider=i,this.offlineComments=r,this.eventsProvider=u,this.commentsSync=s,this.textUtils=c,this.timeUtils=m,this.comments=[],this.commentsLoaded=!1,this.canLoadMore=!1,this.loadMoreError=!1,this.canAddComments=!1,this.canDeleteComments=!1,this.showDelete=!1,this.hasOffline=!1,this.refreshIcon="spinner",this.syncIcon="spinner",this.addDeleteCommentsAvailable=!1,this.contextLevel=n.get("contextLevel"),this.instanceId=n.get("instanceId"),this.componentName=n.get("componentName"),this.itemId=n.get("itemId"),this.area=n.get("area")||"",this.title=n.get("title")||this.translate.instant("core.comments.comments"),this.courseId=n.get("courseId"),this.page=0,this.syncObserver=u.on(f.a.AUTO_SYNCED,function(n){n.contextLevel==_.contextLevel&&n.instanceId==_.instanceId&&n.componentName==_.componentName&&n.itemId==_.itemId&&n.area==_.area&&(_.showSyncWarnings(n.warnings),_.commentsLoaded=!1,_.refreshIcon="spinner",_.syncIcon="spinner",_.domUtils.scrollToTop(_.content),_.page=0,_.comments=[],_.fetchComments(!1))},e.getCurrentSiteId())}return CoreCommentsViewerPage.prototype.ionViewDidLoad=function(){var n=this;this.commentsProvider.isAddCommentsAvailable().then(function(e){n.addDeleteCommentsAvailable=e}),this.currentUserId=this.sitesProvider.getCurrentSiteUserId(),this.fetchComments(!0)},CoreCommentsViewerPage.prototype.fetchComments=function(n,e){var l=this;this.loadMoreError=!1;return(n?this.syncComments(e):Promise.resolve()).catch(function(){}).then(function(){return l.commentsProvider.getComments(l.contextLevel,l.instanceId,l.componentName,l.itemId,l.area,l.page).then(function(n){l.canAddComments=l.addDeleteCommentsAvailable&&n.canpost;var e=n.comments.sort(function(n,e){return e.timecreated-n.timecreated});return l.canLoadMore=void 0!==n.count?l.comments.length+e.length>n.count:n.comments.length>0&&n.comments.length>=m.a.pageSize,Promise.all(e.map(function(n){return l.loadCommentProfile(n)}))}).then(function(n){l.comments=l.comments.concat(n),l.canDeleteComments=l.addDeleteCommentsAvailable&&(l.hasOffline||l.comments.some(function(n){return!!n.delete}))})}).then(function(){return l.loadOfflineData()}).catch(function(n){l.loadMoreError=!0,n&&"assignsubmission_comments"==l.componentName?l.domUtils.showAlertTranslated("core.notice","core.comments.commentsnotworking"):l.domUtils.showErrorModalDefault(n,l.translate.instant("core.error")+": get_comments")}).finally(function(){l.commentsLoaded=!0,l.refreshIcon="refresh",l.syncIcon="sync"})},CoreCommentsViewerPage.prototype.loadMore=function(n){return this.page++,this.canLoadMore=!1,this.fetchComments(!0).finally(function(){n&&n()})},CoreCommentsViewerPage.prototype.refreshComments=function(n,e){var l=this;return this.commentsLoaded=!1,this.refreshIcon="spinner",this.syncIcon="spinner",this.invalidateComments().finally(function(){return l.page=0,l.comments=[],l.fetchComments(!0,n).finally(function(){e&&e.complete()})})},CoreCommentsViewerPage.prototype.showSyncWarnings=function(n){var e=this.textUtils.buildMessage(n);e&&this.domUtils.showErrorModal(e)},CoreCommentsViewerPage.prototype.syncComments=function(n){var e=this;return this.commentsSync.syncComments(this.contextLevel,this.instanceId,this.componentName,this.itemId,this.area).then(function(n){e.showSyncWarnings(n)}).catch(function(l){return n&&e.domUtils.showErrorModalDefault(l,"core.errorsync",!0),Promise.reject(null)})},CoreCommentsViewerPage.prototype.addComment=function(n){var e=this;n.preventDefault(),n.stopPropagation();var l=this.modalCtrl.create("CoreCommentsAddPage",{contextLevel:this.contextLevel,instanceId:this.instanceId,componentName:this.componentName,itemId:this.itemId,area:this.area,content:this.hasOffline?this.offlineComment.content:""});l.onDidDismiss(function(n){return n&&n.comments?(e.invalidateComments(),Promise.all(n.comments.map(function(n){return e.loadCommentProfile(n)})).then(function(n){e.comments=n.concat(e.comments),e.canDeleteComments=e.addDeleteCommentsAvailable,e.eventsProvider.trigger(m.a.COMMENTS_COUNT_CHANGED_EVENT,{contextLevel:e.contextLevel,instanceId:e.instanceId,component:e.componentName,itemId:e.itemId,area:e.area,countChange:n.length},e.sitesProvider.getCurrentSiteId())})):n&&!n.comments?e.loadOfflineData():void 0}),l.present()},CoreCommentsViewerPage.prototype.deleteComment=function(n,e){var l=this;n.preventDefault(),n.stopPropagation();var t=this.timeUtils.userDate(1e3*(e.lastmodified||e.timecreated),"core.strftimerecentfull");e.contextlevel=this.contextLevel,e.instanceid=this.instanceId,e.component=this.componentName,e.itemid=this.itemId,e.area=this.area,this.domUtils.showDeleteConfirm("core.comments.deletecommentbyon",{$a:{user:e.fullname||"",time:t}}).then(function(){l.commentsProvider.deleteComment(e).then(function(n){if(l.showDelete=!1,n){var t=l.comments.findIndex(function(n){return n.id==e.id});t>=0&&(l.comments.splice(t,1),l.eventsProvider.trigger(m.a.COMMENTS_COUNT_CHANGED_EVENT,{contextLevel:l.contextLevel,instanceId:l.instanceId,component:l.componentName,itemId:l.itemId,area:l.area,countChange:-1},l.sitesProvider.getCurrentSiteId()))}else l.loadOfflineData();l.invalidateComments(),l.domUtils.showToast("core.comments.eventcommentdeleted",!0,3e3)}).catch(function(n){l.domUtils.showErrorModalDefault(n,"Delete comment failed.")})}).catch(function(){})},CoreCommentsViewerPage.prototype.invalidateComments=function(){return this.commentsProvider.invalidateCommentsData(this.contextLevel,this.instanceId,this.componentName,this.itemId,this.area)},CoreCommentsViewerPage.prototype.loadCommentProfile=function(n){return this.userProvider.getProfile(n.userid,void 0,!0).then(function(e){return n.profileimageurl=e.profileimageurl,n.fullname=e.fullname,n.userid=e.id,n}).catch(function(){return n})},CoreCommentsViewerPage.prototype.loadOfflineData=function(){var n=this,e=[],l=!1;return e.push(this.offlineComments.getComment(this.contextLevel,this.instanceId,this.componentName,this.itemId,this.area).then(function(e){e&&!n.currentUser?(e.userid=n.currentUserId,n.loadCommentProfile(e).then(function(e){e.fullname&&(n.currentUser={},n.currentUser.profileimageurl=e.profileimageurl,n.currentUser.fullname=e.fullname,n.currentUser.userid=e.userid)})):e&&(e.profileimageurl=n.currentUser.profileimageurl,e.fullname=n.currentUser.fullname,e.userid=n.currentUser.id),n.offlineComment=e})),e.push(this.offlineComments.getDeletedComments(this.contextLevel,this.instanceId,this.componentName,this.itemId,this.area).then(function(e){(l=e&&e.length>0)&&e.forEach(function(e){var l=n.comments.find(function(n){return n.id==e.commentid});l&&(l.deleted=e.deleted)})})),Promise.all(e).then(function(){n.hasOffline=!!n.offlineComment||l})},CoreCommentsViewerPage.prototype.undoDeleteComment=function(n,e){var l=this;n.preventDefault(),n.stopPropagation(),this.offlineComments.undoDeleteComment(e.id).then(function(){e.deleted=!1,l.showDelete=!1})},CoreCommentsViewerPage.prototype.toggleDelete=function(){this.showDelete=!this.showDelete},CoreCommentsViewerPage.prototype.ngOnDestroy=function(){this.syncObserver&&this.syncObserver.off()},CoreCommentsViewerPage}(),h=l(27),p=l(33),C=l(107),g=l(374),y=function(){return function CoreCommentsViewerPageModule(){}}(),v=l(1522),w=l(1523),b=l(1524),I=l(1525),P=l(1526),x=l(1527),V=l(1528),D=l(1529),L=l(1530),k=l(1531),O=l(1532),U=l(1533),N=l(1534),K=l(480),T=l(47),M=l(44),A=l(9),E=l(26),W=l(19),S=l(49),X=l(125),$=l(115),R=l(90),j=l(32),F=l(22),H=l(20),z=l(28),B=l(34),G=l(214),J=l(183),Y=l(21),q=l(3),Q=l(11),Z=l(29),nn=l(161),en=l(8),ln=l(48),tn=l(17),on=l(23),an=l(7),rn=l(18),un=l(16),sn=l(30),cn=l(43),mn=l(41),_n=l(31),fn=l(37),dn=l(281),hn=l(255),pn=l(218),Cn=l(282),gn=l(191),yn=l(228),vn=l(371),wn=l(40),bn=l(723),In=l(212),Pn=l(36),xn=l(473),Vn=l(724),Dn=l(314),Ln=l(247),kn=l(372),On=l(92),Un=l(79),Nn=l(71),Kn=l(77),Tn=l(93),Mn=l(84),An=l(182),En=l(35),Wn=l(108),Sn=l(160),Xn=l(45),$n=l(213),Rn=l(174),jn=l(55),Fn=l(52),Hn=l(373),zn=l(273),Bn=l(70),Gn=l(163),Jn=t._14({encapsulation:2,styles:[],data:{animation:[{type:7,name:"coreSlideInOut",definitions:[{type:1,expr:"void => fromLeft",animation:[{type:6,styles:{transform:"translateX(0)",opacity:1},offset:null},{type:4,styles:{type:5,steps:[{type:6,styles:{opacity:0,transform:"translateX(-100%)",offset:0},offset:null},{type:6,styles:{opacity:1,transform:"translateX(5%)",offset:.7},offset:null},{type:6,styles:{opacity:1,transform:"translateX(0)",offset:1},offset:null}]},timings:300}],options:null},{type:1,expr:"fromLeft => void",animation:[{type:6,styles:{transform:"translateX(-100%)",opacity:0},offset:null},{type:4,styles:{type:5,steps:[{type:6,styles:{opacity:1,transform:"translateX(0)",offset:0},offset:null},{type:6,styles:{opacity:1,transform:"translateX(5%)",offset:.3},offset:null},{type:6,styles:{opacity:0,transform:"translateX(-100%)",offset:1},offset:null}]},timings:300}],options:null},{type:1,expr:"void => fromRight",animation:[{type:6,styles:{transform:"translateX(0)",opacity:1},offset:null},{type:4,styles:{type:5,steps:[{type:6,styles:{opacity:0,transform:"translateX(100%)",offset:0},offset:null},{type:6,styles:{opacity:1,transform:"translateX(-5%)",offset:.7},offset:null},{type:6,styles:{opacity:1,transform:"translateX(0)",offset:1},offset:null}]},timings:300}],options:null},{type:1,expr:"fromRight => void",animation:[{type:6,styles:{transform:"translateX(-100%)",opacity:0},offset:null},{type:4,styles:{type:5,steps:[{type:6,styles:{opacity:1,transform:"translateX(0)",offset:0},offset:null},{type:6,styles:{opacity:1,transform:"translateX(-5%)",offset:.3},offset:null},{type:6,styles:{opacity:0,transform:"translateX(100%)",offset:1},offset:null}]},timings:300}],options:null}],options:{}}]}}),Yn=t._12("page-core-comments-viewer",d,function View_CoreCommentsViewerPage_Host_0(n){return t._42(0,[(n()(),t._16(0,0,null,null,1,"page-core-comments-viewer",[],null,null,null,View_CoreCommentsViewerPage_0,Jn)),t._15(1,180224,null,0,d,[Bn.a,a.a,c.a,i.a,W.a,Gn.a,m.a,_.a,s.a,f.a,r.a,u.a],null,null)],null,null)},{},{},[]),qn=l(24),Qn=l(367),Zn=l(368),ne=l(370),ee=l(369),le=l(472),te=l(722),oe=l(270);l.d(e,"CoreCommentsViewerPageModuleNgFactory",function(){return ae});var ae=t._13(y,[],function(n){return t._25([t._26(512,t.n,t._6,[[8,[v.a,w.a,b.a,I.a,P.a,x.a,V.a,D.a,L.a,k.a,O.a,U.a,N.a,K.a,Yn]],[3,t.n],t.B]),t._26(4608,en.m,en.l,[t.x,[2,en.w]]),t._26(4608,qn.x,qn.x,[]),t._26(4608,qn.d,qn.d,[]),t._26(4608,Qn.b,Qn.a,[]),t._26(4608,Zn.a,Zn.b,[]),t._26(4608,ne.b,ne.a,[]),t._26(4608,ee.b,ee.a,[]),t._26(4608,W.a,W.a,[le.a,Qn.b,Zn.a,ne.b,ee.b,W.b,W.c]),t._26(512,en.b,en.b,[]),t._26(512,qn.v,qn.v,[]),t._26(512,qn.i,qn.i,[]),t._26(512,qn.s,qn.s,[]),t._26(512,te.a,te.a,[]),t._26(512,o.a,o.a,[]),t._26(512,p.a,p.a,[]),t._26(512,C.a,C.a,[]),t._26(512,h.a,h.a,[]),t._26(512,g.a,g.a,[]),t._26(512,te.b,te.b,[]),t._26(512,y,y,[]),t._26(256,W.c,void 0,[]),t._26(256,W.b,void 0,[]),t._26(256,oe.a,d,[])])})}});