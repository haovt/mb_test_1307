webpackJsonp([89],{2107:function(t,e,r){"use strict";function View_AddonModScormPlayerPage_1(t){return o._42(0,[(t()(),o._16(0,0,null,null,6,"button",[["aria-haspopup","true"],["icon-only",""],["ion-button",""]],[[1,"aria-label",0]],[[null,"click"]],function(t,e,r){var o=!0;if("click"===e){o=!1!==t.component.openToc(r)&&o}return o},R.b,R.a)),o._15(1,1097728,[[1,4]],0,O.a,[[8,""],U.a,o.p,o.K],null,null),o._32(131072,x.a,[L.a,o.i]),(t()(),o._40(-1,0,["\n                "])),(t()(),o._16(4,0,null,0,1,"ion-icon",[["name","bookmark"],["role","img"]],[[2,"hide",null]],null,null,null,null)),o._15(5,147456,null,0,G.a,[U.a,o.p,o.K],{name:[0,"name"]},null),(t()(),o._40(-1,0,["\n            "]))],function(t,e){t(e,5,0,"bookmark")},function(t,e){t(e,0,0,o._41(e,0,0,o._29(e,2).transform("addon.mod_scorm.toc")));t(e,4,0,o._29(e,5)._hidden)})}function View_AddonModScormPlayerPage_2(t){return o._42(0,[(t()(),o._16(0,0,null,null,1,"ion-spinner",[],[[2,"spinner-paused",null]],null,null,$.b,$.a)),o._15(1,114688,null,0,H.a,[U.a,o.p,o.K],null,null)],function(t,e){t(e,1,0)},function(t,e){t(e,0,0,o._29(e,1)._paused)})}function View_AddonModScormPlayerPage_3(t){return o._42(0,[(t()(),o._16(0,0,null,null,1,"core-iframe",[],null,null,null,V.b,V.a)),o._15(1,638976,null,0,X.a,[F.a,j.a,l.a,k.c,z.a,K.a,W.a,[2,B.a]],{src:[0,"src"],iframeWidth:[1,"iframeWidth"],iframeHeight:[2,"iframeHeight"]},null)],function(t,e){var r=e.component;t(e,1,0,r.src,r.scorm.popup?r.scorm.width:void 0,r.scorm.popup?r.scorm.height:void 0)},null)}function View_AddonModScormPlayerPage_4(t){return o._42(0,[(t()(),o._16(0,0,null,null,2,"p",[],null,null,null,null,null)),(t()(),o._40(1,null,["",""])),o._32(131072,x.a,[L.a,o.i])],null,function(t,e){var r=e.component;t(e,1,0,o._41(e,1,0,o._29(e,2).transform(r.errorMessage)))})}function View_AddonModScormPlayerPage_0(t){return o._42(0,[(t()(),o._16(0,0,null,null,23,"ion-header",[],null,null,null,null,null)),o._15(1,16384,null,0,J.a,[U.a,o.p,o.K,[2,Y.a]],null,null),(t()(),o._40(-1,null,["\n    "])),(t()(),o._16(3,0,null,null,19,"ion-navbar",[["class","toolbar"],["core-back-button",""]],[[8,"hidden",0],[2,"statusbar-padding",null]],null,null,q.b,q.a)),o._15(4,49152,null,0,Q.a,[Z.a,[2,Y.a],[2,z.a],U.a,o.p,o.K],null,null),o._15(5,212992,null,0,tt.a,[Q.a,et.a,L.a,a.a],null,null),(t()(),o._40(-1,3,["\n        "])),(t()(),o._16(7,0,null,3,3,"ion-title",[],null,null,null,rt.b,rt.a)),o._15(8,49152,null,0,ot.a,[U.a,o.p,o.K,[2,it.a],[2,Q.a]],null,null),(t()(),o._16(9,16777216,null,0,1,"core-format-text",[["contextLevel","module"]],null,null,null,null,null)),o._15(10,540672,null,0,st.a,[o.p,c.a,l.a,nt.a,L.a,et.a,W.a,K.a,F.a,at.a,ct.a,dt.a,[2,z.a],[2,lt.a],[2,B.a],j.a,a.a,mt.a,ut.a,ht.a,o.W],{text:[0,"text"],contextLevel:[1,"contextLevel"],contextInstanceId:[2,"contextInstanceId"],courseId:[3,"courseId"]},null),(t()(),o._40(-1,3,["\n\n        "])),(t()(),o._16(12,0,null,2,9,"ion-buttons",[["end",""]],null,null,null,null,null)),o._15(13,16384,null,1,ft.a,[U.a,o.p,o.K,[2,it.a],[2,Q.a]],null,null),o._37(603979776,1,{_buttons:1}),(t()(),o._40(-1,null,["\n            "])),(t()(),o._11(16777216,null,null,1,null,View_AddonModScormPlayerPage_1)),o._15(17,16384,null,0,_t.k,[o.W,o.T],{ngIf:[0,"ngIf"]},null),(t()(),o._40(-1,null,["\n            "])),(t()(),o._11(16777216,null,null,1,null,View_AddonModScormPlayerPage_2)),o._15(20,16384,null,0,_t.k,[o.W,o.T],{ngIf:[0,"ngIf"]},null),(t()(),o._40(-1,null,["\n        "])),(t()(),o._40(-1,3,["\n    "])),(t()(),o._40(-1,null,["\n"])),(t()(),o._40(-1,null,["\n"])),(t()(),o._16(25,0,null,null,15,"ion-content",[],[[2,"statusbar-padding",null],[2,"has-refresher",null]],null,null,pt.b,pt.a)),o._15(26,4374528,null,0,lt.a,[U.a,et.a,It.a,o.p,o.K,Z.a,vt.a,o.D,[2,Y.a],[2,z.a]],null,null),(t()(),o._40(-1,1,["\n    "])),(t()(),o._16(28,0,null,1,11,"core-loading",[],null,null,null,Et.b,Et.a)),o._15(29,638976,null,0,Mt.a,[L.a,o.p,a.a,W.a],{hideUntil:[0,"hideUntil"]},null),(t()(),o._40(-1,0,["\n        "])),(t()(),o._16(31,0,null,0,1,"core-navigation-bar",[],null,[[null,"action"]],function(t,e,r){var o=!0;if("action"===e){o=!1!==t.component.loadSco(r)&&o}return o},gt.b,gt.a)),o._15(32,49152,null,0,Ct.a,[nt.a],{previous:[0,"previous"],next:[1,"next"]},{action:"action"}),(t()(),o._40(-1,0,["\n        "])),(t()(),o._11(16777216,null,0,1,null,View_AddonModScormPlayerPage_3)),o._15(35,16384,null,0,_t.k,[o.W,o.T],{ngIf:[0,"ngIf"]},null),(t()(),o._40(-1,0,["\n        "])),(t()(),o._11(16777216,null,0,1,null,View_AddonModScormPlayerPage_4)),o._15(38,16384,null,0,_t.k,[o.W,o.T],{ngIf:[0,"ngIf"]},null),(t()(),o._40(-1,0,["\n    "])),(t()(),o._40(-1,1,["\n"])),(t()(),o._40(-1,null,["\n"]))],function(t,e){var r=e.component;t(e,5,0);t(e,10,0,r.title,"module",r.scorm.coursemodule,r.scorm.course);t(e,17,0,r.showToc&&!r.loadingToc&&r.toc&&r.toc.length);t(e,20,0,r.showToc&&r.loadingToc);t(e,29,0,r.loaded);t(e,32,0,r.previousSco,r.nextSco);t(e,35,0,r.loaded&&r.src);t(e,38,0,!r.src&&r.errorMessage)},function(t,e){t(e,3,0,o._29(e,4)._hidden,o._29(e,4)._sbPadding);t(e,25,0,o._29(e,26).statusbarPadding,o._29(e,26)._hasRefresher)})}Object.defineProperty(e,"__esModule",{value:!0});var o=r(1),i=(r(0),r(6),r(4)),s=r(27),n=r(33),a=r(10),c=r(2),d=r(82),l=r(5),m=r(25),u=r(734),h=r(234),f=r(386),_=r(288),p=function(){function AddonModScormDataModel12(t,e,r,o,i,s,n,a,c){this.eventsProvider=t,this.scormProvider=e,this.siteId=r,this.scorm=o,this.scoId=i,this.attempt=s,this.mode=a,this.offline=c,this.CMI_STRING_256="^[\\u0000-\\uFFFF]{0,255}$",this.CMI_STRING_4096="^[\\u0000-\\uFFFF]{0,4096}$",this.CMI_TIME="^([0-2]{1}[0-9]{1}):([0-5]{1}[0-9]{1}):([0-5]{1}[0-9]{1})(.[0-9]{1,2})?$",this.CMI_TIMESPAN="^([0-9]{2,4}):([0-9]{2}):([0-9]{2})(.[0-9]{1,2})?$",this.CMI_INTEGER="^\\d+$",this.CMI_SINTEGER="^-?([0-9]+)$",this.CMI_DECIMAL="^-?([0-9]{0,3})(.[0-9]*)?$",this.CMI_IDENTIFIER="^[\\u0021-\\u007E]{0,255}$",this.CMI_FEEDBACK=this.CMI_STRING_256,this.CMI_INDEX="[._](\\d+).",this.CMI_STATUS="^passed$|^completed$|^failed$|^incomplete$|^browsed$",this.CMI_STATUS_2="^passed$|^completed$|^failed$|^incomplete$|^browsed$|^not attempted$",this.CMI_EXIT="^time-out$|^suspend$|^logout$|^$",this.CMI_TYPE="^true-false$|^choice$|^fill-in$|^matching$|^performance$|^sequencing$|^likert$|^numeric$",this.CMI_RESULT="^correct$|^wrong$|^unanticipated$|^neutral$|^([0-9]{0,3})?(.[0-9]*)?$",this.NAV_EVENT="^previous$|^continue$",this.CMI_CHILDREN="core,suspend_data,launch_data,comments,objectives,student_data,student_preference,interactions",this.CORE_CHILDREN="student_id,student_name,lesson_location,credit,lesson_status,entry,score,total_time,lesson_mode,exit,session_time",this.SCORE_CHILDREN="raw,min,max",this.COMMENTS_CHILDREN="content,location,time",this.OBJECTIVES_CHILDREN="id,score,status",this.CORRECT_RESPONSES_CHILDREN="pattern",this.STUDENT_DATA_CHILDREN="mastery_score,max_time_allowed,time_limit_action",this.STUDENT_PREFERENCE_CHILDREN="audio,language,speed,text",this.INTERACTIONS_CHILDREN="id,objectives,time,type,correct_responses,weighting,student_response,result,latency",this.SCORE_RANGE="0#100",this.AUDIO_RANGE="-1#100",this.SPEED_RANGE="-100#100",this.WEIGHTING_RANGE="-100#100",this.TEXT_RANGE="-1#1",this.ERROR_STRINGS={0:"No error",101:"General exception",201:"Invalid argument error",202:"Element cannot have children",203:"Element not an array - cannot have count",301:"Not initialized",401:"Not implemented error",402:"Invalid set value, element is a keyword",403:"Element is read only",404:"Element is write only",405:"Incorrect data type"},this.currentUserData={},this.def={},this.defExtra={},this.dataModel={},this.initialized=!1,this.mode=a||h.a.MODENORMAL,this.offline=!!c,this.init(n)}return AddonModScormDataModel12.prototype.addTime=function(t,e){var r=t.split(":"),o=e.split(":"),i=r[2].split("."),s=o[2].split("."),n=0,a=0;i.length>1&&(a=parseInt(i[1],10));var c=0;s.length>1&&(c=parseInt(s[1],10));var d=a+c;d-=100*(n=Math.floor(d/100)),Math.floor(d)<10&&(d="0"+d.toString());var l=parseInt(i[0],10)+parseInt(s[0],10)+n;l-=60*(n=Math.floor(l/60)),Math.floor(l)<10&&(l="0"+l.toString());var m=parseInt(r[1],10)+parseInt(o[1],10)+n;(m-=60*(n=Math.floor(m/60)))<10&&(m="0"+m.toString());var u=parseInt(r[0],10)+parseInt(o[0],10)+n;return u<10&&(u="0"+u.toString()),"0"!=d?u+":"+m+":"+l+"."+d:u+":"+m+":"+l},AddonModScormDataModel12.prototype.cloneObj=function(t){if(null==t||"object"!=typeof t)return t;var e=new t.constructor;for(var r in t)e[r]=this.cloneObj(t[r]);return e},AddonModScormDataModel12.prototype.collectData=function(){var t=[];for(var e in this.currentUserData[this.scoId])if("cmi"==e.substr(0,3)){var r=new RegExp(this.CMI_INDEX,"g"),o=String(e).replace(r,".n.");if("cmi.core.session_time"!=e&&(void 0===this.dataModel[this.scoId][e]&&void 0!==this.dataModel[this.scoId][o]&&(this.dataModel[this.scoId][e]=this.cloneObj(this.dataModel[this.scoId][o])),void 0!==this.dataModel[this.scoId][e]&&"r"!=this.dataModel[this.scoId][e].mod)){var i={element:e.replace(r,"_$1."),value:this.getEl(e)};void 0!==this.dataModel[this.scoId][e].defaultvalue?this.dataModel[this.scoId][e].defaultvalue==i.value&&typeof this.dataModel[this.scoId][e].defaultvalue==typeof i.value||(t.push(i),this.dataModel[this.scoId][e].defaultvalue=i.value):(t.push(i),this.dataModel[this.scoId][e].defaultvalue=i.value)}}return t},AddonModScormDataModel12.prototype.getEl=function(t){return void 0!==this.currentUserData[this.scoId]&&void 0!==this.currentUserData[this.scoId][t]?this.currentUserData[this.scoId][t]:""},AddonModScormDataModel12.prototype.init=function(t){for(var e in t){var r=t[e];this.def[e]=r.defaultdata,this.defExtra[e]=r.userdata}for(var e in this.def){this.dataModel[e]={"cmi._children":{defaultvalue:this.CMI_CHILDREN,mod:"r",writeerror:"402"},"cmi._version":{defaultvalue:"3.4",mod:"r",writeerror:"402"},"cmi.core._children":{defaultvalue:this.CORE_CHILDREN,mod:"r",writeerror:"402"},"cmi.core.student_id":{defaultvalue:this.def[e]["cmi.core.student_id"],mod:"r",writeerror:"403"},"cmi.core.student_name":{defaultvalue:this.def[e]["cmi.core.student_name"],mod:"r",writeerror:"403"},"cmi.core.lesson_location":{defaultvalue:this.def[e]["cmi.core.lesson_location"],format:this.CMI_STRING_256,mod:"rw",writeerror:"405"},"cmi.core.credit":{defaultvalue:this.def[e]["cmi.core.credit"],mod:"r",writeerror:"403"},"cmi.core.lesson_status":{defaultvalue:this.def[e]["cmi.core.lesson_status"],format:this.CMI_STATUS,mod:"rw",writeerror:"405"},"cmi.core.entry":{defaultvalue:this.def[e]["cmi.core.entry"],mod:"r",writeerror:"403"},"cmi.core.score._children":{defaultvalue:this.SCORE_CHILDREN,mod:"r",writeerror:"402"},"cmi.core.score.raw":{defaultvalue:this.def[e]["cmi.core.score.raw"],format:this.CMI_DECIMAL,range:this.SCORE_RANGE,mod:"rw",writeerror:"405"},"cmi.core.score.max":{defaultvalue:this.def[e]["cmi.core.score.max"],format:this.CMI_DECIMAL,range:this.SCORE_RANGE,mod:"rw",writeerror:"405"},"cmi.core.score.min":{defaultvalue:this.def[e]["cmi.core.score.min"],format:this.CMI_DECIMAL,range:this.SCORE_RANGE,mod:"rw",writeerror:"405"},"cmi.core.total_time":{defaultvalue:this.def[e]["cmi.core.total_time"],mod:"r",writeerror:"403"},"cmi.core.lesson_mode":{defaultvalue:this.def[e]["cmi.core.lesson_mode"],mod:"r",writeerror:"403"},"cmi.core.exit":{defaultvalue:this.def[e]["cmi.core.exit"],format:this.CMI_EXIT,mod:"w",readerror:"404",writeerror:"405"},"cmi.core.session_time":{format:this.CMI_TIMESPAN,mod:"w",defaultvalue:"00:00:00",readerror:"404",writeerror:"405"},"cmi.suspend_data":{defaultvalue:this.def[e]["cmi.suspend_data"],format:this.CMI_STRING_4096,mod:"rw",writeerror:"405"},"cmi.launch_data":{defaultvalue:this.def[e]["cmi.launch_data"],mod:"r",writeerror:"403"},"cmi.comments":{defaultvalue:this.def[e]["cmi.comments"],format:this.CMI_STRING_4096,mod:"rw",writeerror:"405"},"cmi.evaluation.comments._count":{defaultvalue:"0",mod:"r",writeerror:"402"},"cmi.evaluation.comments._children":{defaultvalue:this.COMMENTS_CHILDREN,mod:"r",writeerror:"402"},"cmi.evaluation.comments.n.content":{defaultvalue:"",pattern:this.CMI_INDEX,format:this.CMI_STRING_256,mod:"rw",writeerror:"405"},"cmi.evaluation.comments.n.location":{defaultvalue:"",pattern:this.CMI_INDEX,format:this.CMI_STRING_256,mod:"rw",writeerror:"405"},"cmi.evaluation.comments.n.time":{defaultvalue:"",pattern:this.CMI_INDEX,format:this.CMI_TIME,mod:"rw",writeerror:"405"},"cmi.comments_from_lms":{mod:"r",writeerror:"403"},"cmi.objectives._children":{defaultvalue:this.OBJECTIVES_CHILDREN,mod:"r",writeerror:"402"},"cmi.objectives._count":{mod:"r",defaultvalue:"0",writeerror:"402"},"cmi.objectives.n.id":{pattern:this.CMI_INDEX,format:this.CMI_IDENTIFIER,mod:"rw",writeerror:"405"},"cmi.objectives.n.score._children":{pattern:this.CMI_INDEX,mod:"r",writeerror:"402"},"cmi.objectives.n.score.raw":{defaultvalue:"",pattern:this.CMI_INDEX,format:this.CMI_DECIMAL,range:this.SCORE_RANGE,mod:"rw",writeerror:"405"},"cmi.objectives.n.score.min":{defaultvalue:"",pattern:this.CMI_INDEX,format:this.CMI_DECIMAL,range:this.SCORE_RANGE,mod:"rw",writeerror:"405"},"cmi.objectives.n.score.max":{defaultvalue:"",pattern:this.CMI_INDEX,format:this.CMI_DECIMAL,range:this.SCORE_RANGE,mod:"rw",writeerror:"405"},"cmi.objectives.n.status":{pattern:this.CMI_INDEX,format:this.CMI_STATUS_2,mod:"rw",writeerror:"405"},"cmi.student_data._children":{defaultvalue:this.STUDENT_DATA_CHILDREN,mod:"r",writeerror:"402"},"cmi.student_data.mastery_score":{defaultvalue:this.def[e]["cmi.student_data.mastery_score"],mod:"r",writeerror:"403"},"cmi.student_data.max_time_allowed":{defaultvalue:this.def[e]["cmi.student_data.max_time_allowed"],mod:"r",writeerror:"403"},"cmi.student_data.time_limit_action":{defaultvalue:this.def[e]["cmi.student_data.time_limit_action"],mod:"r",writeerror:"403"},"cmi.student_preference._children":{defaultvalue:this.STUDENT_PREFERENCE_CHILDREN,mod:"r",writeerror:"402"},"cmi.student_preference.audio":{defaultvalue:this.def[e]["cmi.student_preference.audio"],format:this.CMI_SINTEGER,range:this.AUDIO_RANGE,mod:"rw",writeerror:"405"},"cmi.student_preference.language":{defaultvalue:this.def[e]["cmi.student_preference.language"],format:this.CMI_STRING_256,mod:"rw",writeerror:"405"},"cmi.student_preference.speed":{defaultvalue:this.def[e]["cmi.student_preference.speed"],format:this.CMI_SINTEGER,range:this.SPEED_RANGE,mod:"rw",writeerror:"405"},"cmi.student_preference.text":{defaultvalue:this.def[e]["cmi.student_preference.text"],format:this.CMI_SINTEGER,range:this.TEXT_RANGE,mod:"rw",writeerror:"405"},"cmi.interactions._children":{defaultvalue:this.INTERACTIONS_CHILDREN,mod:"r",writeerror:"402"},"cmi.interactions._count":{mod:"r",defaultvalue:"0",writeerror:"402"},"cmi.interactions.n.id":{pattern:this.CMI_INDEX,format:this.CMI_IDENTIFIER,mod:"w",readerror:"404",writeerror:"405"},"cmi.interactions.n.objectives._count":{pattern:this.CMI_INDEX,mod:"r",defaultvalue:"0",writeerror:"402"},"cmi.interactions.n.objectives.n.id":{pattern:this.CMI_INDEX,format:this.CMI_IDENTIFIER,mod:"w",readerror:"404",writeerror:"405"},"cmi.interactions.n.time":{pattern:this.CMI_INDEX,format:this.CMI_TIME,mod:"w",readerror:"404",writeerror:"405"},"cmi.interactions.n.type":{pattern:this.CMI_INDEX,format:this.CMI_TYPE,mod:"w",readerror:"404",writeerror:"405"},"cmi.interactions.n.correct_responses._count":{pattern:this.CMI_INDEX,mod:"r",defaultvalue:"0",writeerror:"402"},"cmi.interactions.n.correct_responses.n.pattern":{pattern:this.CMI_INDEX,format:this.CMI_FEEDBACK,mod:"w",readerror:"404",writeerror:"405"},"cmi.interactions.n.weighting":{pattern:this.CMI_INDEX,format:this.CMI_DECIMAL,range:this.WEIGHTING_RANGE,mod:"w",readerror:"404",writeerror:"405"},"cmi.interactions.n.student_response":{pattern:this.CMI_INDEX,format:this.CMI_FEEDBACK,mod:"w",readerror:"404",writeerror:"405"},"cmi.interactions.n.result":{pattern:this.CMI_INDEX,format:this.CMI_RESULT,mod:"w",readerror:"404",writeerror:"405"},"cmi.interactions.n.latency":{pattern:this.CMI_INDEX,format:this.CMI_TIMESPAN,mod:"w",readerror:"404",writeerror:"405"},"nav.event":{defaultvalue:"",format:this.NAV_EVENT,mod:"w",readerror:"404",writeerror:"405"}},this.currentUserData[e]={};for(var o in this.dataModel[e])null===o.match(/\.n\./)&&void 0!==this.dataModel[e][o].defaultvalue&&(this.currentUserData[e][o]=this.dataModel[e][o].defaultvalue);for(var o in this.def[e])null===o.match(/\.n\./)&&(this.currentUserData[e][o]=void 0!==this.dataModel[e][o].defaultvalue?this.dataModel[e][o].defaultvalue:void 0!==this.defExtra[e][o]?this.defExtra[e][o]:"");var i=new RegExp(this.CMI_INDEX,"g");for(var o in this.defExtra[e]){var s="",n=0,a=void 0,c=void 0;o.match(i)&&(a=o.replace(i,".$1."),this.currentUserData[e][a]=this.defExtra[e][o],0===a.indexOf("cmi.evaluation.comments")?(s="cmi.evaluation.comments._count",n=a.match(/.(\d+)./)[1]):0===a.indexOf("cmi.objectives")?(s="cmi.objectives._count",n=a.match(/.(\d+)./)[1]):0===a.indexOf("cmi.interactions")&&(a.indexOf(".objectives.")>0?(c=a.match(/cmi.interactions.(\d+)./)[1],n=a.match(/objectives.(\d+)./)[1],s="cmi.interactions."+c+".objectives._count"):a.indexOf(".correct_responses.")>0?(c=a.match(/cmi.interactions.(\d+)./)[1],n=a.match(/correct_responses.(\d+)./)[1],s="cmi.interactions."+c+".correct_responses._count"):(s="cmi.interactions._count",n=a.match(/.(\d+)./)[1])),s&&(void 0===this.currentUserData[e][s]&&(this.currentUserData[e][s]=0),parseInt(n)==parseInt(this.currentUserData[e][s])&&(this.currentUserData[e][s]=parseInt(this.currentUserData[e][s])+1),parseInt(n)>parseInt(this.currentUserData[e][s])&&(this.currentUserData[e][s]=parseInt(n)-1)))}""===this.currentUserData[e]["cmi.core.lesson_status"]&&(this.currentUserData[e]["cmi.core.lesson_status"]="not attempted"),this.currentUserData[e]["cmi.core.credit"]=this.mode==h.a.MODENORMAL?"credit":"no-credit",this.currentUserData[e]["cmi.core.lesson_mode"]=this.mode}},AddonModScormDataModel12.prototype.LMSCommit=function(t){if(this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.errorCode="0",""==t){if(this.initialized){var e=this.storeData(!1);return this.triggerEvent(h.a.UPDATE_TOC_EVENT),this.errorCode=e?"0":"101",e?"true":"false"}this.errorCode="301"}else this.errorCode="201";return"false"},AddonModScormDataModel12.prototype.LMSFinish=function(t){if(this.errorCode="0",""==t){if(this.initialized){this.initialized=!1;var e=this.storeData(!0);return""!=this.getEl("nav.event")?"continue"==this.getEl("nav.event")?this.triggerEvent(h.a.LAUNCH_NEXT_SCO_EVENT):this.triggerEvent(h.a.LAUNCH_PREV_SCO_EVENT):"1"==this.scorm.auto&&this.triggerEvent(h.a.LAUNCH_NEXT_SCO_EVENT),this.errorCode=e?"0":"101",this.triggerEvent(h.a.UPDATE_TOC_EVENT),e?"true":"false"}this.errorCode="301"}else this.errorCode="201";return"false"},AddonModScormDataModel12.prototype.LMSGetDiagnostic=function(t){return""==t&&(t=this.errorCode),t},AddonModScormDataModel12.prototype.LMSGetErrorString=function(t){return""!=t?this.ERROR_STRINGS[t]:""},AddonModScormDataModel12.prototype.LMSGetLastError=function(){return this.errorCode},AddonModScormDataModel12.prototype.LMSGetValue=function(t){if(this.errorCode="0",this.initialized)if(""!=t){var e=new RegExp(this.CMI_INDEX,"g"),r=String(t).replace(e,".n.");if(void 0!==this.dataModel[this.scoId][r]){if("w"!=this.dataModel[this.scoId][r].mod)return this.errorCode="0",this.getEl(t);this.errorCode=this.dataModel[this.scoId][r].readerror}else{if("._children"==r.substr(r.length-"._children".length,r.length)){var o=r.substr(0,r.length-"._children".length);this.errorCode=void 0!==this.dataModel[this.scoId][o]?"202":"201"}else if("._count"==r.substr(r.length-"._count".length,r.length)){o=r.substr(0,r.length-"._count".length);this.errorCode=void 0!==this.dataModel[this.scoId][o]?"203":"201"}else this.errorCode="201"}}else this.errorCode="201";else this.errorCode="301";return""},AddonModScormDataModel12.prototype.LMSInitialize=function(t){if(this.errorCode="0",""==t){if(!this.initialized)return this.initialized=!0,this.errorCode="0","true";this.errorCode="101"}else this.errorCode="201";return"false"},AddonModScormDataModel12.prototype.LMSSetValue=function(t,e){if(this.errorCode="0",this.initialized)if(""!=t){var r=new RegExp(this.CMI_INDEX,"g"),o=String(t).replace(r,".n.");if(void 0!==this.dataModel[this.scoId][o])if("r"!=this.dataModel[this.scoId][o].mod){r=new RegExp(this.dataModel[this.scoId][o].format);if(null!=(e+="").match(r)){if(t!=o){if(0===t.indexOf("cmi.objectives")){var i=t.match(/cmi.objectives.(\d+)./)[1];void 0===this.currentUserData[this.scoId][(d="cmi.objectives."+i+".score")+"._children"]&&(this.setEl(this.currentUserData[this.scoId][d+"._children"],this.SCORE_CHILDREN),this.setEl(this.currentUserData[this.scoId][d+".raw"],""),this.setEl(this.currentUserData[this.scoId][d+".min"],""),this.setEl(this.currentUserData[this.scoId][d+".max"],""))}else if(0===t.indexOf("cmi.interactions")){i=t.match(/cmi.interactions.(\d+)./)[1];void 0===this.currentUserData[this.scoId][d="cmi.interactions."+i+".objectives._count"]&&this.setEl(d,0),void 0===this.currentUserData[this.scoId][d="cmi.interactions."+i+".correct_responses._count"]&&this.setEl(d,0)}for(var s=t.split("."),n="cmi",a=1;a<s.length-1;a++){var c=s[a];if(s[a+1].match(/^\d+$/)){var d;if(void 0===this.currentUserData[this.scoId][d=n+"."+c+"._count"]&&this.setEl(d,0),s[a+1]==this.getEl(d)){var l=this.getEl(d);this.setEl(d,parseInt(l,10)+1)}s[a+1]>this.getEl(d)&&(this.errorCode="201"),n=n.concat("."+c+"."+s[a+1]),a++}else n=n.concat("."+c)}t=n.concat("."+s[s.length-1])}if("0"==this.errorCode){if(this.scorm.autocommit&&!this.timeout&&(this.timeout=setTimeout(this.LMSCommit.bind(this),6e4,[""])),void 0===this.dataModel[this.scoId][o].range)return"cmi.comments"==t?this.setEl("cmi.comments",this.getEl("cmi.comments")+e):this.setEl(t,e),this.errorCode="0","true";var m=this.dataModel[this.scoId][o].range.split("#");if((e*=1)>=m[0]&&e<=m[1])return this.setEl(t,e),this.errorCode="0","true";this.errorCode=this.dataModel[this.scoId][o].writeerror}}else this.errorCode=this.dataModel[this.scoId][o].writeerror}else this.errorCode=this.dataModel[this.scoId][o].writeerror;else this.errorCode="201"}else this.errorCode="201";else this.errorCode="301";return"false"},AddonModScormDataModel12.prototype.loadSco=function(t){this.scoId=t},AddonModScormDataModel12.prototype.setEl=function(t,e){void 0===this.currentUserData[this.scoId]&&(this.currentUserData[this.scoId]={}),this.currentUserData[this.scoId][t]=e},AddonModScormDataModel12.prototype.setOffline=function(t){this.offline=t},AddonModScormDataModel12.prototype.storeData=function(t){var e;t?("not attempted"==this.getEl("cmi.core.lesson_status")&&this.setEl("cmi.core.lesson_status","completed"),this.getEl("cmi.core.lesson_mode")==h.a.MODENORMAL&&"credit"==this.getEl("cmi.core.credit")&&""!==this.getEl("cmi.student_data.mastery_score")&&""!==this.getEl("cmi.core.score.raw")&&(parseFloat(this.getEl("cmi.core.score.raw"))>=parseFloat(this.getEl("cmi.student_data.mastery_score"))?this.setEl("cmi.core.lesson_status","passed"):this.setEl("cmi.core.lesson_status","failed")),this.getEl("cmi.core.lesson_mode")==h.a.MODEBROWSE&&""==this.dataModel[this.scoId]["cmi.core.lesson_status"].defaultvalue&&"not attempted"==this.getEl("cmi.core.lesson_status")&&this.setEl("cmi.core.lesson_status","browsed"),(e=this.collectData()).push(this.totalTime())):e=this.collectData();var r=this.scormProvider.saveTracksSync(this.scoId,this.attempt,e,this.scorm,this.offline,this.currentUserData);return this.offline||r?r:(this.offline=!0,this.triggerEvent(h.a.GO_OFFLINE_EVENT),this.scormProvider.saveTracksSync(this.scoId,this.attempt,e,this.scorm,this.offline,this.currentUserData))},AddonModScormDataModel12.prototype.totalTime=function(){return{element:"cmi.core.total_time",value:this.addTime(this.getEl("cmi.core.total_time"),this.getEl("cmi.core.session_time"))}},AddonModScormDataModel12.prototype.triggerEvent=function(t){this.eventsProvider.trigger(t,{scormId:this.scorm.id,scoId:this.scoId,attempt:this.attempt},this.siteId)},AddonModScormDataModel12}(),I=function(){function AddonModScormPlayerPage(t,e,r,o,i,s,n,a,c,d,l){this.modalCtrl=e,this.eventsProvider=r,this.sitesProvider=o,this.syncProvider=i,this.domUtils=s,this.timeUtils=n,this.scormProvider=a,this.scormHelper=c,this.scormSyncProvider=d,this.tabs=l,this.loadingToc=!0,this.offline=!1,this.scorm=t.get("scorm")||{},this.mode=t.get("mode")||h.a.MODENORMAL,this.newAttempt=!!t.get("newAttempt"),this.organizationId=t.get("organizationId"),this.initialScoId=t.get("scoId"),this.siteId=this.sitesProvider.getCurrentSiteId(),this.title=this.scorm.name,this.syncProvider.blockOperation(h.a.COMPONENT,this.scorm.id,"player")}return AddonModScormPlayerPage.prototype.ngOnInit=function(){var t=this;this.showToc=this.scormProvider.displayTocInPlayer(this.scorm),this.scorm.popup&&(this.tabs.changeVisibility(!1),this.scorm.width<=100&&(this.scorm.width=this.scorm.width+"%"),this.scorm.height<=100&&(this.scorm.height=this.scorm.height+"%")),this.fetchData().then(function(){if(t.currentSco){return(t.newAttempt?t.setStartTime(t.currentSco.id):Promise.resolve()).catch(function(e){t.domUtils.showErrorModalDefault(e,"addon.mod_scorm.errorgetscorm",!0)}).finally(function(){t.loadSco(t.currentSco)})}}).finally(function(){t.loaded=!0}),this.tocObserver=this.eventsProvider.on(h.a.UPDATE_TOC_EVENT,function(e){e.scormId===t.scorm.id&&(t.offline?setTimeout(t.refreshToc.bind(t),100):t.refreshToc())},this.siteId),this.launchNextObserver=this.eventsProvider.on(h.a.LAUNCH_NEXT_SCO_EVENT,function(e){e.scormId===t.scorm.id&&t.nextSco&&t.loadSco(t.nextSco)},this.siteId),this.launchPrevObserver=this.eventsProvider.on(h.a.LAUNCH_PREV_SCO_EVENT,function(e){e.scormId===t.scorm.id&&t.previousSco&&t.loadSco(t.previousSco)},this.siteId),this.goOfflineObserver=this.eventsProvider.on(h.a.GO_OFFLINE_EVENT,function(e){e.scormId!==t.scorm.id||t.offline||(t.offline=!0,setTimeout(function(){t.scormHelper.convertAttemptToOffline(t.scorm,t.attempt).catch(function(e){t.domUtils.showErrorModalDefault(e,"core.error",!0)}).then(function(){t.refreshToc()})},200))},this.siteId)},AddonModScormPlayerPage.prototype.calculateNextAndPreviousSco=function(t){this.previousSco=this.scormHelper.getPreviousScoFromToc(this.toc,t),this.nextSco=this.scormHelper.getNextScoFromToc(this.toc,t)},AddonModScormPlayerPage.prototype.determineAttemptAndMode=function(t){var e,r=this;return this.scormHelper.determineAttemptToContinue(this.scorm,t).then(function(e){return r.attempt=e.number,r.offline=e.offline,r.attempt!=t.lastAttempt.number&&(r.attemptToContinue=r.attempt),r.attempt>0&&r.scormProvider.isAttemptIncomplete(r.scorm.id,r.attempt,r.offline)}).then(function(o){if((e=r.scormProvider.determineAttemptAndMode(r.scorm,r.mode,r.attempt,r.newAttempt,o)).attempt>r.attempt)return r.offline?r.scormHelper.createOfflineAttempt(r.scorm,e.attempt,t.online.length):r.scormProvider.getScormUserData(r.scorm.id,e.attempt,void 0,!1,!0).catch(function(){return r.offline=!0,r.scormHelper.createOfflineAttempt(r.scorm,e.attempt,t.online.length)})}).then(function(){r.mode=e.mode,r.newAttempt=e.newAttempt,r.attempt=e.attempt})},AddonModScormPlayerPage.prototype.fetchData=function(){var t=this;return this.scormSyncProvider.waitForSync(this.scorm.id).then(function(){return t.scormProvider.getAttemptCount(t.scorm.id).then(function(e){return t.determineAttemptAndMode(e).then(function(){var e=[];return e.push(t.fetchToc()),e.push(t.scormProvider.getScormUserData(t.scorm.id,t.attempt,void 0,t.offline).then(function(e){t.userData=e})),e.push(t.scormProvider.getAccessInformation(t.scorm.id).then(function(e){t.accessInfo=e})),Promise.all(e)})}).catch(function(e){t.domUtils.showErrorModalDefault(e,"addon.mod_scorm.errorgetscorm",!0)})})},AddonModScormPlayerPage.prototype.fetchToc=function(){var t=this;return this.loadingToc=!0,this.scormProvider.isAttemptIncomplete(this.scorm.id,this.attempt,this.offline).then(function(e){return t.scorm.incomplete=e,t.scormProvider.getOrganizationToc(t.scorm.id,t.attempt,t.organizationId,t.offline)}).then(function(e){if(t.toc=t.scormProvider.formatTocToArray(e),t.toc.forEach(function(e){e.image=t.scormProvider.getScoStatusIcon(e,t.scorm.incomplete)}),!t.currentSco&&(t.newAttempt&&(t.initialScoId=t.scorm.launch),t.initialScoId>0&&(t.currentSco=t.scormHelper.getScoFromToc(t.toc,t.initialScoId)),!t.currentSco))return t.scormHelper.getFirstSco(t.scorm.id,t.attempt,t.toc,t.organizationId,t.mode,t.offline).then(function(e){e?t.currentSco=e:t.errorMessage="addon.mod_scorm.errornovalidsco"})}).finally(function(){t.loadingToc=!1})},AddonModScormPlayerPage.prototype.ionViewWillUnload=function(){this.src=""},AddonModScormPlayerPage.prototype.loadSco=function(t){var e=this;if(this.dataModel?this.dataModel.loadSco(t.id):(this.dataModel=new p(this.eventsProvider,this.scormProvider,this.siteId,this.scorm,t.id,this.attempt,this.userData,this.mode,this.offline),window.API=this.dataModel),this.currentSco=t,this.title=t.title||this.scorm.name,this.calculateNextAndPreviousSco(t.id),this.scormProvider.getScoSrc(this.scorm,t).then(function(t){t==e.src?(e.src="",setTimeout(function(){e.src=t})):e.src=t}),"asset"==t.scormtype){var r=[{element:"cmi.core.lesson_status",value:"completed"}];this.scormProvider.saveTracks(t.id,this.attempt,r,this.scorm,this.offline).catch(function(){if(!e.offline)return e.scormProvider.getScormUserData(e.scorm.id,e.attempt,void 0,!1).then(function(o){if(!o[t.id]||"completed"!=o[t.id].userdata["cmi.core.lesson_status"])return e.scormHelper.convertAttemptToOffline(e.scorm,e.attempt).then(function(){return e.offline=!0,e.dataModel.setOffline(!0),e.scormProvider.saveTracks(t.id,e.attempt,r,e.scorm,!0)}).catch(function(t){e.domUtils.showErrorModalDefault(t,"core.error",!0)})})}).then(function(){e.refreshToc()})}this.scormProvider.logLaunchSco(this.scorm.id,t.id,this.scorm.name).catch(function(){})},AddonModScormPlayerPage.prototype.openToc=function(t){var e=this,r=this.modalCtrl.create("AddonModScormTocPage",{toc:this.toc,attemptToContinue:this.attemptToContinue,mode:this.mode,selected:this.currentSco&&this.currentSco.id,moduleId:this.scorm.coursemodule,courseId:this.scorm.course,accessInfo:this.accessInfo},{cssClass:"core-modal-lateral",showBackdrop:!0,enableBackdropDismiss:!0,enterAnimation:"core-modal-lateral-transition",leaveAnimation:"core-modal-lateral-transition"});r.onDidDismiss(function(t){t&&e.loadSco(t)}),r.present({ev:t})},AddonModScormPlayerPage.prototype.refreshToc=function(){var t=this;return this.scormProvider.invalidateAllScormData(this.scorm.id).catch(function(){}).then(function(){return t.fetchToc()}).catch(function(e){t.domUtils.showErrorModalDefault(e,"addon.mod_scorm.errorgetscorm",!0)})},AddonModScormPlayerPage.prototype.setStartTime=function(t){var e=this,r=[{element:"x.start.time",value:this.timeUtils.timestamp()}];return this.scormProvider.saveTracks(t,this.attempt,r,this.scorm,this.offline).then(function(){e.offline||e.scormProvider.getAttemptCount(e.scorm.id,!1,!0).catch(function(){})})},AddonModScormPlayerPage.prototype.ngOnDestroy=function(){var t=this;this.tocObserver&&this.tocObserver.off(),this.launchNextObserver&&this.launchNextObserver.off(),this.launchPrevObserver&&this.launchPrevObserver.off(),setTimeout(function(){t.goOfflineObserver&&t.goOfflineObserver.off()},500),this.syncProvider.unblockOperation(h.a.COMPONENT,this.scorm.id,"player"),this.tabs.changeVisibility(!0)},AddonModScormPlayerPage}(),v=function(){return function AddonModScormPlayerPageModule(){}}(),E=r(1522),M=r(1523),g=r(1524),C=r(1525),S=r(1526),D=r(1527),w=r(1528),T=r(1529),N=r(1530),A=r(1531),P=r(1532),y=r(1533),b=r(1534),R=r(47),O=r(44),U=r(9),x=r(26),L=r(19),G=r(49),$=r(122),H=r(102),V=r(323),X=r(257),F=r(7),j=r(43),k=r(80),z=r(21),K=r(23),W=r(3),B=r(29),J=r(371),Y=r(40),q=r(723),Q=r(212),Z=r(36),tt=r(473),et=r(17),rt=r(724),ot=r(314),it=r(247),st=r(48),nt=r(12),at=r(18),ct=r(11),dt=r(16),lt=r(30),mt=r(41),ut=r(31),ht=r(37),ft=r(372),_t=r(8),pt=r(182),It=r(35),vt=r(108),Et=r(55),Mt=r(52),gt=r(775),Ct=r(395),St=r(70),Dt=r(163),wt=o._14({encapsulation:2,styles:[],data:{}}),Tt=o._12("page-addon-mod-scorm-player",I,function View_AddonModScormPlayerPage_Host_0(t){return o._42(0,[(t()(),o._16(0,0,null,null,1,"page-addon-mod-scorm-player",[],null,null,null,View_AddonModScormPlayerPage_0,wt)),o._15(1,245760,null,0,I,[St.a,Dt.a,a.a,c.a,d.a,l.a,m.a,h.a,f.a,_.a,u.a],null,null)],function(t,e){t(e,1,0)},null)},{},{},[]),Nt=r(24),At=r(367),Pt=r(368),yt=r(370),bt=r(369),Rt=r(472),Ot=r(722),Ut=r(107),xt=r(270);r.d(e,"AddonModScormPlayerPageModuleNgFactory",function(){return Lt});var Lt=o._13(v,[],function(t){return o._25([o._26(512,o.n,o._6,[[8,[E.a,M.a,g.a,C.a,S.a,D.a,w.a,T.a,N.a,A.a,P.a,y.a,b.a,Tt]],[3,o.n],o.B]),o._26(4608,_t.m,_t.l,[o.x,[2,_t.w]]),o._26(4608,Nt.x,Nt.x,[]),o._26(4608,Nt.d,Nt.d,[]),o._26(4608,At.b,At.a,[]),o._26(4608,Pt.a,Pt.b,[]),o._26(4608,yt.b,yt.a,[]),o._26(4608,bt.b,bt.a,[]),o._26(4608,L.a,L.a,[Rt.a,At.b,Pt.a,yt.b,bt.b,L.b,L.c]),o._26(512,_t.b,_t.b,[]),o._26(512,Nt.v,Nt.v,[]),o._26(512,Nt.i,Nt.i,[]),o._26(512,Nt.s,Nt.s,[]),o._26(512,Ot.a,Ot.a,[]),o._26(512,i.a,i.a,[]),o._26(512,n.a,n.a,[]),o._26(512,Ut.a,Ut.a,[]),o._26(512,s.a,s.a,[]),o._26(512,Ot.b,Ot.b,[]),o._26(512,v,v,[]),o._26(256,L.c,void 0,[]),o._26(256,L.b,void 0,[]),o._26(256,xt.a,I,[])])})}});