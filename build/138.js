webpackJsonp([138],{2114:function(n,e,l){"use strict";function View_AddonCalendarListPage_1(n){return t._42(0,[(n()(),t._16(0,0,null,null,1,"ion-icon",[["name","funnel"],["role","img"]],[[2,"hide",null]],null,null,null,null)),t._15(1,147456,null,0,H.a,[U.a,t.p,t.K],{name:[0,"name"]},null)],function(n,e){n(e,1,0,"funnel")},function(n,e){n(e,0,0,t._29(e,1)._hidden)})}function View_AddonCalendarListPage_2(n){return t._42(0,[(n()(),t._16(0,0,null,null,1,"ion-icon",[["name","ios-funnel-outline"],["role","img"]],[[2,"hide",null]],null,null,null,null)),t._15(1,147456,null,0,H.a,[U.a,t.p,t.K],{name:[0,"name"]},null)],function(n,e){n(e,1,0,"ios-funnel-outline")},function(n,e){n(e,0,0,t._29(e,1)._hidden)})}function View_AddonCalendarListPage_3(n){return t._42(0,[(n()(),t._16(0,0,null,null,8,"ion-card",[["class","core-warning-card"],["icon-start",""]],null,null,null,null,null)),t._15(1,16384,null,0,F.a,[U.a,t.p,t.K],null,null),(n()(),t._40(-1,null,["\n                "])),(n()(),t._16(3,0,null,null,1,"ion-icon",[["name","warning"],["role","img"]],[[2,"hide",null]],null,null,null,null)),t._15(4,147456,null,0,H.a,[U.a,t.p,t.K],{name:[0,"name"]},null),(n()(),t._40(5,null,[" ","\n            "])),t._32(131072,Y.a,[j.a,t.i]),t._33(7,{$a:0}),t._32(131072,Y.a,[j.a,t.i])],function(n,e){n(e,4,0,"warning")},function(n,e){n(e,3,0,t._29(e,4)._hidden);n(e,5,0,t._41(e,5,0,t._29(e,8).transform("core.hasdatatosync",n(e,7,0,t._41(e,5,0,t._29(e,6).transform("addon.calendar.calendar"))))))})}function View_AddonCalendarListPage_4(n){return t._42(0,[(n()(),t._16(0,0,null,null,3,"core-empty-box",[["icon","calendar"]],null,null,null,z.b,z.a)),t._15(1,49152,null,0,B.a,[],{message:[0,"message"],icon:[1,"icon"]},null),t._32(131072,Y.a,[j.a,t.i]),(n()(),t._40(-1,0,["\n            "]))],function(n,e){n(e,1,0,t._41(e,1,0,t._29(e,2).transform("addon.calendar.noevents")),"calendar")},null)}function View_AddonCalendarListPage_7(n){return t._42(0,[(n()(),t._16(0,0,null,null,7,"ion-item-divider",[["class","item item-divider"]],null,null,null,G.b,G.a)),t._15(1,1097728,null,3,J.a,[q.a,U.a,t.p,t.K,[2,Q.a]],null,null),t._37(335544320,4,{contentLabel:0}),t._37(603979776,5,{_buttons:1}),t._37(603979776,6,{_icons:1}),t._15(5,16384,null,0,X.a,[U.a,t.p,t.K],null,null),(n()(),t._40(6,2,["\n                        ","\n                    "])),t._34(7,2)],null,function(n,e){n(e,6,0,t._41(e,6,0,n(e,7,0,t._29(e.parent.parent.parent,0),1e3*e.parent.context.$implicit.timestart,"strftimedayshort")))})}function View_AddonCalendarListPage_8(n){return t._42(0,[(n()(),t._16(0,0,null,null,0,"img",[["class","core-module-icon"],["item-start",""]],[[8,"src",4]],null,null,null,null))],null,function(n,e){n(e,0,0,t._19(1,"",e.parent.context.$implicit.moduleIcon,""))})}function View_AddonCalendarListPage_9(n){return t._42(0,[(n()(),t._16(0,0,null,null,1,"core-icon",[["item-start",""]],null,null,null,Z.b,Z.a)),t._15(1,704512,null,0,nn.a,[t.p,U.a],{name:[0,"name"]},null)],function(n,e){n(e,1,0,e.parent.context.$implicit.eventIcon)},null)}function View_AddonCalendarListPage_10(n){return t._42(0,[(n()(),t._16(0,0,null,null,2,"span",[],null,null,null,null,null)),(n()(),t._40(1,null,[" - ",""])),t._34(2,2)],null,function(n,e){n(e,1,0,t._41(e,1,0,n(e,2,0,t._29(e.parent.parent.parent,0),1e3*(e.parent.context.$implicit.timestart+e.parent.context.$implicit.timeduration),"strftimetime")))})}function View_AddonCalendarListPage_11(n){return t._42(0,[(n()(),t._16(0,0,null,null,2,"span",[],null,null,null,null,null)),(n()(),t._40(1,null,[" - ",""])),t._34(2,2)],null,function(n,e){n(e,1,0,t._41(e,1,0,n(e,2,0,t._29(e.parent.parent.parent,0),1e3*(e.parent.context.$implicit.timestart+e.parent.context.$implicit.timeduration),"strftimedatetimeshort")))})}function View_AddonCalendarListPage_12(n){return t._42(0,[(n()(),t._16(0,0,null,null,9,"ion-note",[["item-end",""]],null,null,null,null,null)),t._15(1,16384,null,0,en.a,[U.a,t.p,t.K],null,null),(n()(),t._40(-1,null,["\n                            "])),(n()(),t._16(3,0,null,null,1,"ion-icon",[["name","time"],["role","img"]],[[2,"hide",null]],null,null,null,null)),t._15(4,147456,null,0,H.a,[U.a,t.p,t.K],{name:[0,"name"]},null),(n()(),t._40(-1,null,["\n                            "])),(n()(),t._16(6,0,null,null,2,"span",[["text-wrap",""]],null,null,null,null,null)),(n()(),t._40(7,null,["",""])),t._32(131072,Y.a,[j.a,t.i]),(n()(),t._40(-1,null,["\n                        "]))],function(n,e){n(e,4,0,"time")},function(n,e){n(e,3,0,t._29(e,4)._hidden);n(e,7,0,t._41(e,7,0,t._29(e,8).transform("core.notsent")))})}function View_AddonCalendarListPage_13(n){return t._42(0,[(n()(),t._16(0,0,null,null,9,"ion-note",[["item-end",""]],null,null,null,null,null)),t._15(1,16384,null,0,en.a,[U.a,t.p,t.K],null,null),(n()(),t._40(-1,null,["\n                            "])),(n()(),t._16(3,0,null,null,1,"ion-icon",[["name","trash"],["role","img"]],[[2,"hide",null]],null,null,null,null)),t._15(4,147456,null,0,H.a,[U.a,t.p,t.K],{name:[0,"name"]},null),(n()(),t._40(-1,null,["\n                            "])),(n()(),t._16(6,0,null,null,2,"span",[["text-wrap",""]],null,null,null,null,null)),(n()(),t._40(7,null,["",""])),t._32(131072,Y.a,[j.a,t.i]),(n()(),t._40(-1,null,["\n                        "]))],function(n,e){n(e,4,0,"trash")},function(n,e){n(e,3,0,t._29(e,4)._hidden);n(e,7,0,t._41(e,7,0,t._29(e,8).transform("core.deletedoffline")))})}function View_AddonCalendarListPage_6(n){return t._42(0,[(n()(),t._16(0,0,null,null,40,null,null,null,null,null,null,null)),(n()(),t._40(-1,null,["\n                    "])),(n()(),t._11(16777216,null,null,1,null,View_AddonCalendarListPage_7)),t._15(3,16384,null,0,ln.k,[t.W,t.T],{ngIf:[0,"ngIf"]},null),(n()(),t._40(-1,null,["\n                    "])),(n()(),t._16(5,0,null,null,34,"a",[["class","addon-calendar-event item item-block"],["ion-item",""],["text-wrap",""]],[[8,"title",0],[2,"core-split-item-selected",null]],[[null,"click"]],function(n,e,l){var t=!0;if("click"===e){t=!1!==n.component.gotoEvent(n.context.$implicit.id)&&t}return t},G.b,G.a)),t._15(6,278528,null,0,ln.i,[t.v,t.w,t.p,t.L],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),t._31(7,1),t._15(8,1097728,null,3,J.a,[q.a,U.a,t.p,t.K,[2,Q.a]],null,null),t._37(335544320,7,{contentLabel:0}),t._37(603979776,8,{_buttons:1}),t._37(603979776,9,{_icons:1}),t._15(12,16384,null,0,tn.a,[],null,null),(n()(),t._40(-1,2,["\n                        "])),(n()(),t._11(16777216,null,0,1,null,View_AddonCalendarListPage_8)),t._15(15,16384,null,0,ln.k,[t.W,t.T],{ngIf:[0,"ngIf"]},null),(n()(),t._40(-1,2,["\n                        "])),(n()(),t._11(16777216,null,0,1,null,View_AddonCalendarListPage_9)),t._15(18,16384,null,0,ln.k,[t.W,t.T],{ngIf:[0,"ngIf"]},null),(n()(),t._40(-1,2,["\n                        "])),(n()(),t._16(20,0,null,2,2,"h2",[],null,null,null,null,null)),(n()(),t._16(21,16777216,null,null,1,"core-format-text",[],null,null,null,null,null)),t._15(22,540672,null,0,an.a,[t.p,g.a,h.a,rn.a,j.a,on.a,p.a,un.a,sn.a,dn.a,C.a,cn.a,[2,_n.a],[2,fn.a],[2,b.a],hn.a,E.a,vn.a,pn.a,gn.a,t.W],{text:[0,"text"],contextLevel:[1,"contextLevel"],contextInstanceId:[2,"contextInstanceId"]},null),(n()(),t._40(-1,2,["\n                        "])),(n()(),t._16(24,0,null,2,8,"p",[],null,null,null,null,null)),(n()(),t._40(25,null,["\n                            ","\n                            "])),t._34(26,2),(n()(),t._11(16777216,null,null,1,null,View_AddonCalendarListPage_10)),t._15(28,16384,null,0,ln.k,[t.W,t.T],{ngIf:[0,"ngIf"]},null),(n()(),t._40(-1,null,["\n                            "])),(n()(),t._11(16777216,null,null,1,null,View_AddonCalendarListPage_11)),t._15(31,16384,null,0,ln.k,[t.W,t.T],{ngIf:[0,"ngIf"]},null),(n()(),t._40(-1,null,["\n                        "])),(n()(),t._40(-1,2,["\n                        "])),(n()(),t._11(16777216,null,4,1,null,View_AddonCalendarListPage_12)),t._15(35,16384,null,0,ln.k,[t.W,t.T],{ngIf:[0,"ngIf"]},null),(n()(),t._40(-1,2,["\n                        "])),(n()(),t._11(16777216,null,4,1,null,View_AddonCalendarListPage_13)),t._15(38,16384,null,0,ln.k,[t.W,t.T],{ngIf:[0,"ngIf"]},null),(n()(),t._40(-1,2,["\n                    "])),(n()(),t._40(-1,null,["\n                "]))],function(n,e){n(e,3,0,e.context.$implicit.showDate);n(e,6,0,"addon-calendar-event",n(e,7,0,"addon-calendar-eventtype-"+e.context.$implicit.eventtype));n(e,15,0,e.context.$implicit.moduleIcon);n(e,18,0,e.context.$implicit.eventIcon&&!e.context.$implicit.moduleIcon);n(e,22,0,e.context.$implicit.name,e.context.$implicit.contextLevel,e.context.$implicit.contextInstanceId);n(e,28,0,e.context.$implicit.timeduration&&e.context.$implicit.endsSameDay);n(e,31,0,e.context.$implicit.timeduration&&!e.context.$implicit.endsSameDay);n(e,35,0,e.context.$implicit.offline&&!e.context.$implicit.deleted);n(e,38,0,e.context.$implicit.deleted)},function(n,e){n(e,5,0,e.context.$implicit.name,e.context.$implicit.id==e.component.eventId);n(e,25,0,t._41(e,25,0,n(e,26,0,t._29(e.parent.parent,0),1e3*e.context.$implicit.timestart,"strftimetime")))})}function View_AddonCalendarListPage_5(n){return t._42(0,[(n()(),t._16(0,0,null,null,5,"ion-list",[["no-margin",""]],null,null,null,null,null)),t._15(1,16384,null,0,mn.a,[U.a,t.p,t.K,on.a,En.l,Cn.a],null,null),(n()(),t._40(-1,null,["\n                "])),(n()(),t._11(16777216,null,null,1,null,View_AddonCalendarListPage_6)),t._15(4,802816,null,0,ln.j,[t.W,t.T,t.v],{ngForOf:[0,"ngForOf"]},null),(n()(),t._40(-1,null,["\n            "]))],function(n,e){n(e,4,0,e.component.filteredEvents)},null)}function View_AddonCalendarListPage_14(n){return t._42(0,[(n()(),t._16(0,0,null,null,13,"ion-fab",[["bottom",""],["core-fab",""],["end",""]],null,null,null,bn.b,bn.a)),t._15(1,212992,null,0,Ln.a,[t.p,fn.a],null,null),t._15(2,1228800,null,2,In.a,[on.a],null,null),t._37(335544320,10,{_mainButton:0}),t._37(603979776,11,{_fabLists:1}),(n()(),t._40(-1,0,["\n            "])),(n()(),t._16(6,0,null,0,6,"button",[["ion-fab",""]],[[1,"aria-label",0]],[[null,"click"]],function(n,e,l){var t=!0;if("click"===e){t=!1!==n.component.openEdit()&&t}return t},An.b,An.a)),t._15(7,49152,[[10,4]],0,yn.a,[U.a,t.p,t.K],null,null),t._32(131072,Y.a,[j.a,t.i]),(n()(),t._40(-1,0,["\n                "])),(n()(),t._16(10,0,null,0,1,"ion-icon",[["name","add"],["role","img"]],[[2,"hide",null]],null,null,null,null)),t._15(11,147456,null,0,H.a,[U.a,t.p,t.K],{name:[0,"name"]},null),(n()(),t._40(-1,0,["\n            "])),(n()(),t._40(-1,0,["\n        "]))],function(n,e){n(e,1,0);n(e,11,0,"add")},function(n,e){n(e,6,0,t._41(e,6,0,t._29(e,8).transform("addon.calendar.newevent")));n(e,10,0,t._29(e,11)._hidden)})}function View_AddonCalendarListPage_0(n){return t._42(0,[t._32(0,Pn.a,[sn.a,v.a]),t._37(402653184,1,{content:0}),t._37(402653184,2,{splitviewCtrl:0}),(n()(),t._16(3,0,null,null,40,"ion-header",[],null,null,null,null,null)),t._15(4,16384,null,0,wn.a,[U.a,t.p,t.K,[2,On.a]],null,null),(n()(),t._40(-1,null,["\n    "])),(n()(),t._16(6,0,null,null,36,"ion-navbar",[["class","toolbar"],["core-back-button",""]],[[8,"hidden",0],[2,"statusbar-padding",null]],null,null,Dn.b,Dn.a)),t._15(7,49152,null,0,Tn.a,[xn.a,[2,On.a],[2,_n.a],U.a,t.p,t.K],null,null),t._15(8,212992,null,0,Vn.a,[Tn.a,on.a,j.a,E.a],null,null),(n()(),t._40(-1,3,["\n        "])),(n()(),t._16(10,0,null,3,3,"ion-title",[],null,null,null,Sn.b,Sn.a)),t._15(11,49152,null,0,Nn.a,[U.a,t.p,t.K,[2,kn.a],[2,Tn.a]],null,null),(n()(),t._40(12,0,["",""])),t._32(131072,Y.a,[j.a,t.i]),(n()(),t._40(-1,3,["\n        "])),(n()(),t._16(15,0,null,2,26,"ion-buttons",[["end",""]],null,null,null,null,null)),t._15(16,16384,null,1,$n.a,[U.a,t.p,t.K,[2,kn.a],[2,Tn.a]],null,null),t._37(603979776,3,{_buttons:1}),(n()(),t._40(-1,null,["\n            "])),(n()(),t._16(19,0,null,null,9,"button",[["icon-only",""],["ion-button",""]],[[1,"aria-label",0]],[[null,"click"]],function(n,e,l){var t=!0;if("click"===e){t=!1!==n.component.openFilter(l)&&t}return t},Kn.b,Kn.a)),t._15(20,1097728,[[3,4]],0,Mn.a,[[8,""],U.a,t.p,t.K],null,null),t._32(131072,Y.a,[j.a,t.i]),(n()(),t._40(-1,0,["\n                "])),(n()(),t._11(16777216,null,0,1,null,View_AddonCalendarListPage_1)),t._15(24,16384,null,0,ln.k,[t.W,t.T],{ngIf:[0,"ngIf"]},null),(n()(),t._40(-1,0,["\n                "])),(n()(),t._11(16777216,null,0,1,null,View_AddonCalendarListPage_2)),t._15(27,16384,null,0,ln.k,[t.W,t.T],{ngIf:[0,"ngIf"]},null),(n()(),t._40(-1,0,["\n            "])),(n()(),t._40(-1,null,["\n            "])),(n()(),t._16(30,0,null,null,10,"core-context-menu",[],null,null,null,Rn.b,Rn.a)),t._15(31,245760,null,0,Wn.a,[j.a,Hn.a,t.p,h.a,[2,Un.a],p.a],null,null),(n()(),t._40(-1,0,["\n                "])),(n()(),t._16(33,0,null,0,2,"core-context-menu-item",[],null,[[null,"action"]],function(n,e,l){var t=!0;if("action"===e){t=!1!==n.component.openSettings()&&t}return t},Fn.b,Fn.a)),t._15(34,770048,null,0,Yn.a,[Wn.a],{content:[0,"content"],iconAction:[1,"iconAction"],priority:[2,"priority"],hidden:[3,"hidden"]},{action:"action"}),t._32(131072,Y.a,[j.a,t.i]),(n()(),t._40(-1,0,["\n                "])),(n()(),t._16(37,0,null,0,2,"core-context-menu-item",[],null,[[null,"action"]],function(n,e,l){var t=!0;if("action"===e){t=!1!==n.component.doRefresh(null,l,!0)&&t}return t},Fn.b,Fn.a)),t._15(38,770048,null,0,Yn.a,[Wn.a],{content:[0,"content"],iconAction:[1,"iconAction"],closeOnClick:[2,"closeOnClick"],priority:[3,"priority"],hidden:[4,"hidden"]},{action:"action"}),t._32(131072,Y.a,[j.a,t.i]),(n()(),t._40(-1,0,["\n            "])),(n()(),t._40(-1,null,["\n        "])),(n()(),t._40(-1,3,["\n    "])),(n()(),t._40(-1,null,["\n"])),(n()(),t._40(-1,null,["\n"])),(n()(),t._16(45,0,null,null,35,"core-split-view",[],null,null,null,jn.b,jn.a)),t._15(46,245760,[[2,4]],0,b.a,[[2,_n.a],t.p,zn.a,on.a,j.a],null,null),(n()(),t._40(-1,0,["\n    "])),(n()(),t._16(48,0,null,0,31,"ion-content",[],[[2,"statusbar-padding",null],[2,"has-refresher",null]],null,null,Bn.b,Bn.a)),t._15(49,4374528,[[1,4]],0,fn.a,[U.a,on.a,Cn.a,t.p,t.K,xn.a,Gn.a,t.D,[2,On.a],[2,_n.a]],null,null),(n()(),t._40(-1,1,["\n        "])),(n()(),t._16(51,0,null,2,6,"ion-refresher",[],[[2,"refresher-active",null],[4,"top",null]],[[null,"ionRefresh"]],function(n,e,l){var t=!0;if("ionRefresh"===e){t=!1!==n.component.doRefresh(l)&&t}return t},null,null)),t._15(52,212992,null,0,Jn.a,[on.a,fn.a,t.D,En.l],{enabled:[0,"enabled"]},{ionRefresh:"ionRefresh"}),(n()(),t._40(-1,null,["\n            "])),(n()(),t._16(54,0,null,null,2,"ion-refresher-content",[],[[1,"state",0]],null,null,qn.b,qn.a)),t._15(55,114688,null,0,Qn.a,[Jn.a,U.a],{pullingText:[0,"pullingText"]},null),t._32(131072,Y.a,[j.a,t.i]),(n()(),t._40(-1,null,["\n        "])),(n()(),t._40(-1,1,["\n        "])),(n()(),t._16(59,0,null,1,15,"core-loading",[],null,null,null,Xn.b,Xn.a)),t._15(60,638976,null,0,Zn.a,[j.a,t.p,E.a,p.a],{hideUntil:[0,"hideUntil"]},null),(n()(),t._40(-1,0,["\n            "])),(n()(),t._40(-1,0,["\n            "])),(n()(),t._11(16777216,null,0,1,null,View_AddonCalendarListPage_3)),t._15(64,16384,null,0,ln.k,[t.W,t.T],{ngIf:[0,"ngIf"]},null),(n()(),t._40(-1,0,["\n\n            "])),(n()(),t._11(16777216,null,0,1,null,View_AddonCalendarListPage_4)),t._15(67,16384,null,0,ln.k,[t.W,t.T],{ngIf:[0,"ngIf"]},null),(n()(),t._40(-1,0,["\n\n            "])),(n()(),t._11(16777216,null,0,1,null,View_AddonCalendarListPage_5)),t._15(70,16384,null,0,ln.k,[t.W,t.T],{ngIf:[0,"ngIf"]},null),(n()(),t._40(-1,0,["\n\n            "])),(n()(),t._16(72,0,null,0,1,"core-infinite-loading",[],null,[[null,"action"]],function(n,e,l){var t=!0;if("action"===e){t=!1!==n.component.loadMoreEvents(l)&&t}return t},ne.b,ne.a)),t._15(73,573440,null,0,ee.a,[[2,fn.a],h.a],{enabled:[0,"enabled"],error:[1,"error"]},{action:"action"}),(n()(),t._40(-1,0,["\n        "])),(n()(),t._40(-1,1,["\n\n        "])),(n()(),t._40(-1,1,["\n        "])),(n()(),t._11(16777216,null,0,1,null,View_AddonCalendarListPage_14)),t._15(78,16384,null,0,ln.k,[t.W,t.T],{ngIf:[0,"ngIf"]},null),(n()(),t._40(-1,1,["\n    "])),(n()(),t._40(-1,0,["\n"]))],function(n,e){var l=e.component;n(e,8,0);n(e,24,0,l.filter.filtered);n(e,27,0,!l.filter.filtered),n(e,31,0);n(e,34,0,t._41(e,34,0,t._29(e,35).transform("core.settings.settings")),"cog",600,!l.notificationsEnabled);n(e,38,0,t._41(e,38,0,t._29(e,39).transform("core.settings.synchronizenow")),l.syncIcon,!1,400,!l.eventsLoaded||!l.hasOffline||!l.isOnline),n(e,46,0);n(e,52,0,l.eventsLoaded);n(e,55,0,t._19(1,"",t._41(e,55,0,t._29(e,56).transform("core.pulltorefresh")),""));n(e,60,0,l.eventsLoaded);n(e,64,0,l.hasOffline);n(e,67,0,!l.filteredEvents||!l.filteredEvents.length);n(e,70,0,l.filteredEvents&&l.filteredEvents.length);n(e,73,0,l.canLoadMore,l.loadMoreError);n(e,78,0,l.canCreate)},function(n,e){n(e,6,0,t._29(e,7)._hidden,t._29(e,7)._sbPadding);n(e,12,0,t._41(e,12,0,t._29(e,13).transform("addon.calendar.calendarevents")));n(e,19,0,t._41(e,19,0,t._29(e,21).transform("core.filter")));n(e,48,0,t._29(e,49).statusbarPadding,t._29(e,49)._hasRefresher);n(e,51,0,"inactive"!==t._29(e,52).state,t._29(e,52)._top);n(e,54,0,t._29(e,55).r.state)})}Object.defineProperty(e,"__esModule",{value:!0});var t=l(1),i=(l(0),l(6),l(4)),a=l(27),r=l(33),o=l(107),u=l(187),s=l(275),d=l(276),c=l(478),_=l(53),f=l(189),h=l(5),v=l(25),p=l(3),g=l(2),m=l(152),E=l(10),C=l(11),b=l(29),L=l(15),I=l(186),A=l(42),y=l(746),P=function(){function AddonCalendarListPage(n,e,l,t,i,a,r,o,s,d,_,f,h,v,p,g,m,E){var C=this;this.calendarProvider=a,this.domUtils=r,this.coursesProvider=o,this.utils=s,this.calendarHelper=d,this.coursesHelper=_,this.eventsProvider=f,this.navCtrl=h,this.appProvider=v,this.calendarOffline=p,this.calendarSync=g,this.timeUtils=m,this.popoverCtrl=E,this.initialTime=0,this.daysLoaded=0,this.emptyEventsTimes=0,this.categoriesRetrieved=!1,this.getCategories=!1,this.categories={},this.onlineEvents=[],this.offlineEvents=[],this.deletedEvents=[],this.eventsLoaded=!1,this.events=[],this.notificationsEnabled=!1,this.filteredEvents=[],this.canLoadMore=!1,this.loadMoreError=!1,this.canCreate=!1,this.hasOffline=!1,this.isOnline=!1,this.filter={filtered:!1,courseId:null,categoryId:null,course:!1,group:!1,site:!1,user:!1,category:!1},this.siteHomeId=e.getCurrentSite().getSiteHomeId(),this.notificationsEnabled=i.isAvailable(),this.currentSiteId=e.getCurrentSiteId(),this.notificationsEnabled&&(this.obsDefaultTimeChange=f.on(u.a.DEFAULT_NOTIFICATION_TIME_CHANGED,function(){a.scheduleEventsNotifications(C.onlineEvents)},this.currentSiteId)),this.eventId=n.get("eventId")||!1,u.a.ALL_TYPES.forEach(function(n){C.filter[n]=!0}),this.filter.courseId=n.get("courseId"),this.newEventObserver=f.on(u.a.NEW_EVENT_EVENT,function(n){n&&n.event&&(C.splitviewCtrl.isOn()&&C.splitviewCtrl.emptyDetails(),C.eventsLoaded=!1,C.refreshEvents(!0,!1).finally(function(){C.splitviewCtrl.isOn()&&n.event.id>0&&C.gotoEvent(n.event.id)}))},this.currentSiteId),this.discardedObserver=f.on(u.a.NEW_EVENT_DISCARDED_EVENT,function(){C.splitviewCtrl.isOn()&&C.splitviewCtrl.emptyDetails(),C.eventsLoaded=!1,C.refreshEvents(!0,!1)},this.currentSiteId),this.editEventObserver=f.on(u.a.EDIT_EVENT_EVENT,function(n){n&&n.event&&(C.eventsLoaded=!1,C.refreshEvents(!0,!1))},this.currentSiteId),this.syncObserver=f.on(c.a.AUTO_SYNCED,function(n){C.eventsLoaded=!1,C.refreshEvents(),C.splitviewCtrl.isOn()&&C.eventId&&n&&n.deleted&&-1!=n.deleted.indexOf(C.eventId)&&C.splitviewCtrl.emptyDetails()},this.currentSiteId),this.manualSyncObserver=f.on(c.a.MANUAL_SYNCED,function(n){n&&"list"!=n.source&&(C.eventsLoaded=!1,C.refreshEvents()),C.splitviewCtrl.isOn()&&C.eventId&&n&&n.deleted&&-1!=n.deleted.indexOf(C.eventId)&&C.splitviewCtrl.emptyDetails()},this.currentSiteId),this.deleteEventObserver=f.on(u.a.DELETED_EVENT_EVENT,function(n){n&&!n.sent?(C.markAsDeleted(n.eventId,!0),C.deletedEvents.push(n.eventId),C.hasOffline=!0):(C.splitviewCtrl.isOn()&&C.splitviewCtrl.emptyDetails(),C.eventsLoaded=!1,C.refreshEvents())},this.currentSiteId),this.undeleteEventObserver=f.on(u.a.UNDELETED_EVENT_EVENT,function(n){if(n&&n.eventId){C.markAsDeleted(n.eventId,!1);var e=C.deletedEvents.indexOf(n.eventId);-1!=e&&C.deletedEvents.splice(e,1),C.hasOffline=!!C.offlineEvents.length||!!C.deletedEvents.length}},this.currentSiteId),this.filterChangedObserver=this.eventsProvider.on(u.a.FILTER_CHANGED_EVENT,function(n){C.filter=n,C.calendarHelper.canEditEvents(C.filter.courseId).then(function(n){C.canCreate=n}),C.filterEvents(),C.domUtils.scrollToTop(C.content)}),this.onlineObserver=l.onchange().subscribe(function(){t.run(function(){C.isOnline=C.appProvider.isOnline()})})}return AddonCalendarListPage.prototype.ionViewDidLoad=function(){var n=this;this.eventId&&this.gotoEvent(this.eventId),this.syncIcon="spinner",this.fetchData(!1,!0,!1).then(function(){!n.eventId&&n.splitviewCtrl.isOn()&&n.events.length>0&&n.gotoEvent(n.onlineEvents[0]?n.onlineEvents[0].id:n.offlineEvents[0].id)})},AddonCalendarListPage.prototype.fetchData=function(n,e,l){var t=this;this.initialTime=this.timeUtils.timestamp(),this.daysLoaded=0,this.emptyEventsTimes=0,this.isOnline=this.appProvider.isOnline();return(e?this.calendarSync.syncEvents().then(function(n){n.warnings&&n.warnings.length&&t.domUtils.showErrorModal(n.warnings[0]),n.updated&&(n.source="list",t.eventsProvider.trigger(c.a.MANUAL_SYNCED,n,t.currentSiteId))}).catch(function(n){l&&t.domUtils.showErrorModalDefault(n,"core.errorsync",!0)}):Promise.resolve()).then(function(){var e=[];return t.hasOffline=!1,e.push(t.calendarHelper.canEditEvents(t.filter.courseId).then(function(n){t.canCreate=n})),e.push(t.coursesHelper.getCoursesForPopover(t.filter.courseId).then(function(e){return t.courses=e.courses,t.fetchEvents(n)})),e.push(t.calendarOffline.getAllEditedEvents().then(function(n){t.hasOffline=t.hasOffline||!!n.length,n.forEach(function(n){n.offline=!0,t.calendarHelper.formatEventData(n)}),t.offlineEvents=t.sortEvents(n)})),e.push(t.calendarOffline.getAllDeletedEventsIds().then(function(n){t.hasOffline=t.hasOffline||!!n.length,t.deletedEvents=n})),Promise.all(e)}).finally(function(){t.eventsLoaded=!0,t.syncIcon="sync"})},AddonCalendarListPage.prototype.fetchEvents=function(n){var e=this;return this.loadMoreError=!1,this.calendarProvider.getEventsList(this.initialTime,this.daysLoaded,u.a.DAYS_INTERVAL).then(function(l){if(0===l.length){if(e.emptyEventsTimes++,!(e.emptyEventsTimes>5))return e.daysLoaded+=u.a.DAYS_INTERVAL,e.fetchEvents();e.canLoadMore=!1,n&&(e.onlineEvents=[],e.filteredEvents=[],e.events=e.offlineEvents)}else{l.forEach(e.calendarHelper.formatEventData.bind(e.calendarHelper));var t=e.mergeEvents(l);e.getCategories=e.shouldLoadCategories(l),n?(e.onlineEvents=l,e.events=t):(e.onlineEvents=e.utils.mergeArraysWithoutDuplicates(e.onlineEvents,l,"id"),e.events=e.utils.mergeArraysWithoutDuplicates(e.events,t,"id")),e.filterEvents(),e.filteredEvents.forEach(function(n,l){n.showDate=e.showDate(n,e.filteredEvents[l-1]),n.endsSameDay=e.endsSameDay(n)}),e.canLoadMore=!0,e.calendarProvider.scheduleEventsNotifications(e.onlineEvents),e.daysLoaded+=u.a.DAYS_INTERVAL}e.content.resize()}).catch(function(n){e.domUtils.showErrorModalDefault(n,"addon.calendar.errorloadevents",!0),e.loadMoreError=!0}).then(function(){if(e.getCategories)return e.getCategories=!1,e.loadCategories()})},AddonCalendarListPage.prototype.loadMoreEvents=function(n){return this.fetchEvents().finally(function(){n&&n()})},AddonCalendarListPage.prototype.filterEvents=function(){this.filteredEvents=this.calendarHelper.getFilteredEvents(this.events,this.filter,this.categories)},AddonCalendarListPage.prototype.shouldLoadCategories=function(n){if(this.categoriesRetrieved||this.getCategories)return this.getCategories;return n.some(function(n){return"undefined"!=n.categoryid&&n.categoryid>0})||this.getCategories},AddonCalendarListPage.prototype.loadCategories=function(){var n=this;return this.coursesProvider.getCategories(0,!0).then(function(e){n.categoriesRetrieved=!0,n.categories={},e.forEach(function(e){n.categories[e.id]=e})}).catch(function(){})},AddonCalendarListPage.prototype.mergeEvents=function(n){var e=this;if(!this.offlineEvents.length&&!this.deletedEvents.length)return n;var l=this.initialTime+A.a.SECONDS_DAY*this.daysLoaded,t=l+A.a.SECONDS_DAY*u.a.DAYS_INTERVAL-1,i=n;this.deletedEvents.length&&i.forEach(function(n){n.deleted=-1!=e.deletedEvents.indexOf(n.id)}),this.offlineEvents.length&&(i=i.filter(function(n){return!e.offlineEvents.find(function(e){return e.id==n.id})}));var a=this.offlineEvents.filter(function(n){return 0==e.daysLoaded&&n.timestart<l||(n.timestart>=l||n.timestart+n.timeduration>=l)&&n.timestart<=t});return i=i.concat(a),this.sortEvents(i)},AddonCalendarListPage.prototype.sortEvents=function(n){return n.sort(function(n,e){return n.timestart==e.timestart?n.timeduration-e.timeduration:n.timestart-e.timestart})},AddonCalendarListPage.prototype.doRefresh=function(n,e,l){return this.eventsLoaded?this.refreshEvents(!0,l).finally(function(){n&&n.complete(),e&&e()}):Promise.resolve()},AddonCalendarListPage.prototype.refreshEvents=function(n,e){var l=this;this.syncIcon="spinner";var t=[];return t.push(this.calendarProvider.invalidateEventsList()),t.push(this.calendarProvider.invalidateAllowedEventTypes()),this.categoriesRetrieved&&(t.push(this.coursesProvider.invalidateCategories(0,!0)),this.categoriesRetrieved=!1),Promise.all(t).finally(function(){return l.fetchData(!0,n,e)})},AddonCalendarListPage.prototype.showDate=function(n,e){return!e||!L(1e3*n.timestart).isSame(1e3*e.timestart,"day")},AddonCalendarListPage.prototype.endsSameDay=function(n){return!n.timeduration||L(1e3*n.timestart).isSame(1e3*(n.timestart+n.timeduration),"day")},AddonCalendarListPage.prototype.openFilter=function(n){this.popoverCtrl.create(y.a,{courses:this.courses,filter:this.filter}).present({ev:n})},AddonCalendarListPage.prototype.openEdit=function(n){this.eventId=void 0;var e={};n&&(e.eventId=n),this.filter.courseId&&(e.courseId=this.filter.courseId),this.splitviewCtrl.push("AddonCalendarEditEventPage",e)},AddonCalendarListPage.prototype.openSettings=function(){this.navCtrl.push("AddonCalendarSettingsPage")},AddonCalendarListPage.prototype.gotoEvent=function(n){this.eventId=n,n<0?this.openEdit(n):this.splitviewCtrl.push("AddonCalendarEventPage",{id:n})},AddonCalendarListPage.prototype.markAsDeleted=function(n,e){var l=this.onlineEvents.find(function(e){return e.id==n});l&&(l.deleted=e)},AddonCalendarListPage.prototype.ngOnDestroy=function(){this.obsDefaultTimeChange&&this.obsDefaultTimeChange.off(),this.newEventObserver&&this.newEventObserver.off(),this.discardedObserver&&this.discardedObserver.off(),this.editEventObserver&&this.editEventObserver.off(),this.deleteEventObserver&&this.deleteEventObserver.off(),this.undeleteEventObserver&&this.undeleteEventObserver.off(),this.syncObserver&&this.syncObserver.off(),this.manualSyncObserver&&this.manualSyncObserver.off(),this.filterChangedObserver&&this.filterChangedObserver.off(),this.onlineObserver&&this.onlineObserver.unsubscribe()},AddonCalendarListPage}(),w=function(){return function AddonCalendarListPageModule(){}}(),O=l(1522),D=l(1523),T=l(1524),x=l(1525),V=l(1526),S=l(1527),N=l(1528),k=l(1529),$=l(1530),K=l(1531),M=l(1532),R=l(1533),W=l(1534),H=l(49),U=l(9),F=l(90),Y=l(26),j=l(19),z=l(125),B=l(115),G=l(32),J=l(22),q=l(20),Q=l(28),X=l(101),Z=l(81),nn=l(76),en=l(248),ln=l(8),tn=l(34),an=l(48),rn=l(12),on=l(17),un=l(23),sn=l(7),dn=l(18),cn=l(16),_n=l(21),fn=l(30),hn=l(43),vn=l(41),pn=l(31),gn=l(37),mn=l(87),En=l(45),Cn=l(35),bn=l(281),Ln=l(255),In=l(218),An=l(282),yn=l(191),Pn=l(228),wn=l(371),On=l(40),Dn=l(723),Tn=l(212),xn=l(36),Vn=l(473),Sn=l(724),Nn=l(314),kn=l(247),$n=l(372),Kn=l(47),Mn=l(44),Rn=l(92),Wn=l(79),Hn=l(71),Un=l(77),Fn=l(93),Yn=l(84),jn=l(474),zn=l(73),Bn=l(182),Gn=l(108),Jn=l(160),qn=l(213),Qn=l(174),Xn=l(55),Zn=l(52),ne=l(373),ee=l(273),le=l(70),te=t._14({encapsulation:2,styles:[],data:{}}),ie=t._12("page-addon-calendar-list",P,function View_AddonCalendarListPage_Host_0(n){return t._42(0,[(n()(),t._16(0,0,null,null,1,"page-addon-calendar-list",[],null,null,null,View_AddonCalendarListPage_0,te)),t._15(1,180224,null,0,P,[le.a,g.a,I.a,t.D,m.a,u.a,h.a,_.a,p.a,d.a,f.a,E.a,_n.a,C.a,s.a,c.a,v.a,Hn.a],null,null)],null,null)},{},{},[]),ae=l(24),re=l(367),oe=l(368),ue=l(370),se=l(369),de=l(472),ce=l(722),_e=l(270);l.d(e,"AddonCalendarListPageModuleNgFactory",function(){return fe});var fe=t._13(w,[],function(n){return t._25([t._26(512,t.n,t._6,[[8,[O.a,D.a,T.a,x.a,V.a,S.a,N.a,k.a,$.a,K.a,M.a,R.a,W.a,ie]],[3,t.n],t.B]),t._26(4608,ln.m,ln.l,[t.x,[2,ln.w]]),t._26(4608,ae.x,ae.x,[]),t._26(4608,ae.d,ae.d,[]),t._26(4608,re.b,re.a,[]),t._26(4608,oe.a,oe.b,[]),t._26(4608,ue.b,ue.a,[]),t._26(4608,se.b,se.a,[]),t._26(4608,j.a,j.a,[de.a,re.b,oe.a,ue.b,se.b,j.b,j.c]),t._26(512,ln.b,ln.b,[]),t._26(512,ae.v,ae.v,[]),t._26(512,ae.i,ae.i,[]),t._26(512,ae.s,ae.s,[]),t._26(512,ce.a,ce.a,[]),t._26(512,i.a,i.a,[]),t._26(512,r.a,r.a,[]),t._26(512,o.a,o.a,[]),t._26(512,a.a,a.a,[]),t._26(512,ce.b,ce.b,[]),t._26(512,w,w,[]),t._26(256,j.c,void 0,[]),t._26(256,j.b,void 0,[]),t._26(256,_e.a,P,[])])})}});